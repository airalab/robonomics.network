(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{UQSp:function(t,e,o){"use strict";e.a={name:"VueRemarkRoot",render(t){return t("div",null,this.$slots.default)}}},ljlx:function(t,e,o){"use strict";o.r(e);var n=o("KHd+"),a=o("UQSp"),r=o("Kw5r");function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.a.config.optionMergeStrategies;var s={VueRemarkRoot:a.a},l=function(t){var e=t.options.components=t.options.components||{},o=t.options.computed=t.options.computed||{};Object.keys(s).forEach((function(t){"object"===i(s[t])&&"function"==typeof s[t].render||"function"==typeof s[t]&&"function"==typeof s[t].options.render?e[t]=s[t]:o[t]=function(){return s[t]}}))},d=r.a.config.optionMergeStrategies,h="__vueRemarkFrontMatter",c={excerpt:null,title:"Hacked Johnny's Lab",date:"2024-06-25T00:00:00.000Z",published:!0,locale:"en",tags:["Events","Online school","Web3"],cover_image:"./images/hacked-johnnys-lab/cover.png",description:"There was a recent event “Hack Johnny’s Lab” by Robonomics and I believe I did hack it in a way! Apart from the very first try which I lost due to rules misunderstanding, I won every round I took part in and here is a short “howto” story.",abstract:"Hey there! PaTara on the line. There was a recent event “Hack Johnny’s Lab” by Robonomics and I believe I did hack it in a way! Apart from the very first try which I lost due to rules misunderstanding, I won every round I took part in and here is a short “howto” story. Pavel Tarasov [PaTara]"};var m=function(t){t.options[h]&&(t.options[h]=c),r.a.util.defineReactive(t.options,h,c),t.options.computed=d.computed({$frontmatter:function(){return t.options[h]}},t.options.computed)},p=Object(n.a)({},(function(){var t=this,e=t._self._c;return e("VueRemarkRoot",[e("p",[t._v("So, a quick and necessary rules recap: 12 words in a mixed order, a 5-minute video of a TurtleBot 4 wandering around a lab \nand spoiling the mnemonic phrase word order, 5-20 participants willing to win and a free Sunday to think up a strategy.")]),e("rb-image",{attrs:{zoom:"",src:"./images/hacked-johnnys-lab/0.png",alt:"Game Interface"}}),e("p",[t._v("I’m sort of familiar with programming and I have a decent laptop and almost no skill in image recognition. More than that, \nI decided to play it fairly, which means no video downloading, no playback speed abuse, no playbar navigation. \nSo the picked strategy was a good old bruteforce. Sounds more hacking that anything.\nWhat do we have here: a set of 12 words in a mixed order. This gives us 12! (factorial) options of phrases \n(479’001’600 to be precise). Quite an amount to process!")]),e("h2",{attrs:{id:"strategy-1-dumb-and-straightforward"}},[e("a",{attrs:{href:"#strategy-1-dumb-and-straightforward","aria-hidden":"true"}},[e("span",{staticClass:"icon icon-link"})]),t._v("Strategy 1: dumb and straightforward.")]),e("p",[t._v("Well, what else do I need, just go and sort through! But here is the first trick: 12! mnemonic phrases just didn’t fit in \nmy 64 GB RAM! I got a SIGTERM error in the IDE console. \nSo I created an "),e("a",{attrs:{href:"https://docs.python.org/3/library/itertools.html#itertools.permutations",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("iterator")]),t._v(" and started the process. \nIt took me some time, not sure exactly, how much, but within 30 seconds, to calculate the number of combinations. \nJust an evaluative run. But the thing is: my laptop didn’t even spin its fans at max! A single core was loaded. ")]),e("p",[t._v("I googled a Python "),e("a",{attrs:{href:"https://docs.python.org/3/library/multiprocessing.html",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("multiprocessing")]),t._v(" package to load all \nthe logical cores of my CPU (20 of them) to parallel the computations. Otherwise, it would have been an eternal journey. \nBut with that I had to split my iterator in 12 parts. The itertools multiprocessing packages do work together, \nbut when a whole set of options is in the RAM. That was not my case, so the following was performed:")]),e("rb-image",{attrs:{zoom:"",src:"./images/hacked-johnnys-lab/1.png",alt:"Parallelizing"}}),e("p",[t._v("From that moment and ever I would use this strategy to make my CPU load monitor look like this:")]),e("rb-image",{attrs:{zoom:"",src:"./images/hacked-johnnys-lab/1_1.png",alt:"CPU Load"}}),e("p",[t._v("I believe this shortened the execution time down to around 5 seconds. I got the best way to iterate through \nthe combinations but there were just too many of them! The first step involved performing roughly 480 millions \nextrinsics in the network. The node would simply ban me for DDOS and even without that It would take forever!")]),e("rb-image",{attrs:{zoom:"",src:"./images/hacked-johnnys-lab/2.png",alt:"1st Attempt"}}),e("p",[t._v("Just for a debugging reason I started the script (for node communication I used a \n"),e("a",{attrs:{href:"https://pypi.org/project/substrate-interface/1.0.3/",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("py-substrate-interface")]),t._v(" package) and noticed that prior to call \nperforming I got errors like "),e("em",[t._v("invalid mnemonic phrase")]),t._v(". A clue! If I could validate the combination on prem, \nI would save tons of time! GitHub parsing led me to \n"),e("a",{attrs:{href:"https://github.com/polkascan/py-substrate-interface/blob/master/substrateinterface/keypair.py#L170",target:"_blank",rel:"nofollow noopener noreferrer"}},[t._v("this")]),t._v(" \nline of code and I added a combination validation to my script. This has reduced the number of potential extrinsics down\nto roughly 39’000’000 12 times faster!")]),e("rb-image",{attrs:{zoom:"",src:"./images/hacked-johnnys-lab/3.png",alt:"2nd Attempt"}}),e("p",[t._v("But still, 39 million calls would ban me forever, so I needed more digging. How could I significantly cut the \nnumber of calculations? Well, by a little bit betraying my initial strategy. See, I was going to avoid video watching, \n“a hacker, who won’t even need a video”, but the math made me change my mind. Change it to a 132 times faster strategy. \nBelow is the explanation:")]),e("rb-image",{attrs:{zoom:"",src:"./images/hacked-johnnys-lab/4.png",alt:"2 Words Insertion"}}),e("p",[t._v("With that I only needed to know two correct positions of words in a phrase (one would take too long, experiment-validated). \nI would iterate through a 10! combinations, insert two words in correct positions and validate the phrase, \ncutting down the options to approximately 300’000 quite a decrease! More that, 10! combinations set fitted in my RAM, excellent!")]),e("rb-image",{attrs:{zoom:"",src:"./images/hacked-johnnys-lab/5.png",alt:"3rd Attempt"}}),e("p",[t._v("Also, rather than trying to transfer all the tokens each 300k times and calling a public node for that I decided to set \nup my own local Robonomics node synchronized with the chain and ask it for a resulting account address balance! \nQuery is way “easier” than an extrinsic. After a whole night of synchronizing (I’ve set a cache limit so that my \nlaptop won’t blow up with chain data in its ROM) I gave it a try and.. this was a disaster. Network transactions \n(even within a localhost) took too much time. I didn’t even wait till the end, it was obviously way slower than \nwatching a whole video. If only I could know the exact address of the account! But for that I need a mnemonic phrase… "),e("strong",[t._v("Or do I really?")])]),e("p",[t._v("Look. The rules say that the desired account has "),e("strong",[t._v("exactly")]),t._v(" 42 XRT. Why wouldn’t I get all the active addresses in the network,\nfilter them by having exactly 42 XRT and compare each generated address with a list of possible targets \n(around 20, decreasing to 1 in the end). Easy to say and to do. ")]),e("p",[t._v("Now, after modifying my script once more I finally made it to only one query and one transaction which would for sure \ngive me the desired prize.")]),e("rb-image",{attrs:{zoom:"",src:"./images/hacked-johnnys-lab/6.png",alt:"4th Attempt"}}),e("p",[t._v("Now, after I watched 25 seconds of the video (meanwhile filling in the words of a mnemonic), \nI would only need 30 seconds at max to steal the reward. Hacked it.")]),e("rb-image",{attrs:{zoom:"",src:"./images/hacked-johnnys-lab/7.png",alt:"Discord Bot Notification"}})],1)}),[],!1,null,null,null);"function"==typeof l&&l(p),"function"==typeof m&&m(p);e.default=p.exports}}]);