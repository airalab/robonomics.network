---
title: ハッキン���されたジョニーの研究室
date: 2024-06-25
published: true
locale: 'ja'
tags: ['Events', 'Online school', 'Web3', ]
cover_image: ../images/hacked-johnnys-lab/cover.png
description: 最近、Robonomicsによるイベント「Hack Johnny's Lab」があり、私はある意味でそれをハックしたと思います！最初の試みはルールの誤解により失敗しましたが、参加したすべてのラウンドで勝利し、ここに短い「ハウツー」ストーリーがあります。
abstract: "こんにちは！PaTaraです。最近、Robonomicsによるイベント「Hack Johnny's Lab」があり、私はある意味でそれをハックしたと思います！最初の試みはルールの誤解により失敗しましたが、参加したすべてのラウンドで勝利し、ここに短い「ハウツー」ストーリーがあります。 "
---

では、ルールを簡単にまとめると、12 個の単語が混在した順序で並べられ、TurtleBot 4 がラボ内を歩き回り、記憶術のフレーズの語順を台無しにする 5 分間のビデオ、勝利を目指す 5 ～ 20 人の参加者、戦略を考えるための自由な日曜日です。

<rb-image zoom src="./images/hacked-johnnys-lab/0.png" alt="Game Interface" />

私はプログラミングにはある程度慣れており、まあまあのラップトップを持っていますが、画像認識のスキルはほとんどありません。それ以上に、 
ビデオのダウンロードや再生速度の乱用、プレイバーのナビゲーションなどは一切行わないと決めました。 
選択した戦略は古典的なブルートフォースでした。それは何よりもハッキングらしいです。
ここに何��あるのか：順不同の12語のセット。これにより、12！（階乗）のフレーズのオプションが得られます 
（正確に479'001'600）。処理するにはかなりの量です！


## 戦略1：愚かで率直なもの。

さて、他に何が必要か、ただ行って整理するだけです！しかし、最初のトリックがここにあります：12！ニーモニックフレーズはうまく収まりませんでした 
私の64GB RAM！IDEコンソール��SIGTERMエラーが発生しました。 
そこで、[イテレータ](https://docs.python.org/3/library/itertools.html#itertools.permutations) を作成し、プロセスを開始しました。
組み合わせの数を計算するのに、正確な時間はわかりませんが、30 秒以内で時間がかかりました。
評価用の実行です。しかし問題は、私のラップトップはさえぎりファンを最大速度で回転させることさえありませんでした！1つのコアが負荷をかけられました。 

私はすべての論理コア（20個）を並列計算するためにPythonの[multiprocessing](https://docs.python.org/3/library/multiprocessing.html)パッケージを調べました。そうしないと、永遠の旅になってしまいます。 
しかし、そのためにはイテレータを12つに分割する必要がありました。itertools multiprocessingパッケージは一緒に動作しますが、 
オプションのセット全体がRAMにある場合です。それは私の場合ではなかったので、次のように行いました。 
その時点から、私は常にこの戦略を使って、CPUの負荷モニターをこのように見せるようにしました。

<rb-image zoom src="./images/hacked-johnnys-lab/1.png" alt="Parallelizing"/>


これにより、実行時間が約5秒に短縮されたと思います。組み合わせを繰り返す最良の方法を得ましたが、それらがあまりにも多すぎました！最初のステップは、おおよそ480百万の

<rb-image zoom src="./images/hacked-johnnys-lab/1_1.png" alt="CPU Load"/>


ネットワーク内の外部入力を実行することでした。ノードは私をDDOSのために単純に禁止し、それさえなくても永遠にかかってしまいます！ 
デバッグのために、スクリプトを開始しました（ノードとの通信には 
[py-substrate-interface](https://pypi.org/project/substrate-interface/1.0.3/)パッケージを使用しました）

<rb-image zoom src="./images/hacked-johnnys-lab/2.png" alt="1st Attempt"/>


そして、呼び出しを行う前に、_無効なニーモニックフレーズ_のようなエラーが発生したことに気づきました。手がかり！プレミアムで組み合わせを検証できれば、 
多くの時間を節約できると思いました！GitHubの解析により、私は 
[これ](https://github.com/polkascan/py-substrate-interface/blob/master/substrateinterface/keypair.py#L170) 
コード行にたどり着き、スクリプトに組み合わせの検証を追加しました。これにより、潜在的な外部入力の数がおおよそ39'000'000倍速く減少しました！ 
しかし、それでも、3900万回の呼び出しは永遠に私を禁止するでしょう。だから、もっと掘り下げる必要がありました。どうやって計算の数を大幅に削減できるでしょうか？ 
少し初期の戦略を裏切ることで、それを実現できます。ビデオの視聴を避けるつもりでしたが、
「ビデオを必要としないハッカー」という考えを変えさせたの���数学でした。132倍速い戦略に変更しました。

<rb-image zoom src="./images/hacked-johnnys-lab/3.png" alt="2nd Attempt"/>


以下に説明します。 
それにより、フレーズ内の単語の2つの正しい位置だけを知る必要がありました（1つだけだと時間がかかりすぎることが実験で確認されました）。 
10！の組み合わせを繰り返し、2つの単語を正しい位置に挿入し、フレーズを検証し、 
オプションを約300'000に削減しました。さらに、10！の組み合わせセットは私のRAMに収まりました、素晴らしい！

<rb-image zoom src="./images/hacked-johnnys-lab/4.png" alt="2 Words Insertion"/>


自分のローカルRobonomicsノードをチェーンと同期させ、その結果のアカウントアドレス残高を尋ねました！ 
クエリは外部入力よりも「簡単」です。同期化を一晩中行った後（ROM内のチェーンデータでラップトップが爆発しないようにキャッシュ制限を設定しました）、試してみましたが...これは災難でした。ネットワークトランザクション 
（localhost内でも）時間がかかりすぎました。最後まで待つこともなく、明らかにビデオ全体を見るよりも遅かったです。アカウントの正確なアドレスを知ることができればいいのですが！しかし、そのためにはニーモニックフレーズが必要です... **本当に必要なのでしょうか？**

<rb-image zoom src="./images/hacked-johnnys-lab/5.png" alt="3rd Attempt"/>


また、すべてのトークンを300k回転送し、それに対して公開ノードを呼び出す代わりに、私は設定することに決めました 
自分自身のローカルRobonomicsノードをチェーンと同期させ、その結果のアカウントアドレス残高を尋ねます！ 
クエリは、外部のものよりはるかに「簡単」です。一晩中同期した後（ラップトップが ROM 内のチェーン データでクラッシュしないようにキャッシュ制限を設定しました）、試してみましたが、これは大失敗でした。ネットワーク トランザクション
（ローカル���スト内でも）時間がかかりすぎました。最後まで待つこともなく、明らかにビデオ全体を見るよりも遅かったです 
アカウントの正確なアドレスを知ることができればいいのに！でもそのためにはニーモニックフレーズが必要です... **本当に必要なのか？**

見て。ルー��によると、望ましいアカウントには**正確に**42 XRTが必要です。なぜなら、ネットワーク内のすべてのアクティブなアドレスを取得し、
正確に42 XRTを持つものをフィルタリングし、生成された各アドレスを可能なターゲットのリストと比較します 
(約20、最後に1に減少)。言うのは簡単ですが、やるのは簡単です。 

さて、スクリプトをもう一度修正した後、確実に望ましい賞品を手に入れることができる 
1つのクエリと1つのトランザクションになりました。

<rb-image zoom src="./images/hacked-johnnys-lab/6.png" alt="4th Attempt"/>


さて、ビデオを25秒間見た後（その間にニーモニックの単語を入力している）、 
報酬を盗むのに最大30秒しかかからないでしょう。ハッキングしました。

<rb-image zoom src="./images/hacked-johnnys-lab/7.png" alt="Discord Bot Notification"/>



