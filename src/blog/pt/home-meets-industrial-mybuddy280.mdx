---
title: "Automatização: Casa encontra Industrial"
date: 2024-03-24
published: true
locale: 'pt'
cover_image: /blog/images/automation-home-meets-industrial-mybuddy280/Cover.png
description: "O ROS 2 é um framework que está rapidamente se tornando popular para o desenvolvimento de aplicações de robótica. Ele inclui a experiência acumulada da indústria e a compartilha com a comunidade global. Nossa equipe está ativamente envolvida no desenvolvimento de novos pacotes ROS 2 para os robôs que usamos, bem como integrando-os na rede descentralizada Robonomics."
related: ['Robonomics Helps Enable Rust for ROS 2']
abstract: "O ROS 2 é um framework que está rapidamente se tornando popular para o desenvolvimento de aplicações de robótica. Ele inclui a experiência acumulada da indústria e a compartilha com a comunidade global. Nossa equipe está ativamente envolvida no desenvolvimento de novos pacotes ROS 2 para os robôs que usamos, bem como integrando-os na rede descentralizada Robonomics."
tags: ['ROS 2', 'Casa Inteligente']
---

Tecnologias desenvolvidas em uma indústria frequentemente se encontram sendo amplamente aplicadas em outras indústrias, mesmo que não tenham sido originalmente projetadas para elas. Assim, a internet, originalmente desenvolvida para uso militar, revelou seu potencial completo na esfera civil, tornando-se uma parte integral da vida moderna. Uma tendência semelhante pode ocorrer na indústria, onde tecnologias desenvolvidas para cenários empresariais também podem beneficiar os usuários finais.

Historicamente, a automação residencial e a robótica industrial evoluíram separadamente. Devido ao seu alto custo e preocupações com segurança, os robôs industriais foram principalmente limitados à produção em larga escala. O software para gerenciar a produção estava confinado dentro de sistemas proprietários de execução de manufatura e manufatura assistida por computador. A automação residencial, ao mesmo tempo, geralmente representava um sistema de dispositivos bastante simples para interagir com gadgets do usuário, eletrodomésticos, iluminação, aquecimento, comunicação. O foco na comunicação estava na comunicação sem fio.

No entanto, estamos observando tendências. Por um lado, protocolos de comunicação sem fio da esfera do consumidor estão sendo gradualmente adaptados para aplicações industriais — por exemplo, versões industriais de Wi-Fi ou Bluetooth estão surgindo. Por outro lado, os robôs manipuladores estão se tornando mais acessíveis e começam a ser considerados para uso além da indústria. Mesmo agora, podemos refletir sobre como, no futuro, por exemplo, robôs colaborativos seguros se tornarão uma parte integral da casa e serão capazes de tornar nossas vidas mais convenientes, ajudando na culinária e em outras tarefas domésticas rotineiras. Além disso, implementações de código aberto de protocolos de comunicação industrial — como o protocolo de middleware DDS sobo ROS 2 - estão se tornando o patrimônio de entusiastas de todo o mundo.

O ROS 1 foi desenvolvido para gerenciamento de robô único e não conseguia atender aos requisitos das empresas de manufatura: operação em tempo real, tolerância a falhas em condições de comunicação instáveis, interação com um grande número de dispositivos. Assim, começou o desenvolvimento do ROS 2, que foi originalmente posicionado especificamente para as necessidades da indústria e agora está se tornando mainstream na robótica. No meio de 2023, um evento importante ocorreu - 5 anos após o surgimento do ROS 2 Dashing em 2019, o número de pacotes ROS 2 usados por engenheiros, de acordo com [metrics.ros.org](https://metrics.ros.org/packages_rosdistro.html), superou os pacotes ROS 1 e agora cerca de 70% dos pacotes de software baixados dos repositórios oficiais são para ROS 2.

## Vantagens do ROS 2 para cenários de automação residencial

A equipe da Robonomics está na vanguarda desse processo e apoia ativamente a Comunidade ROS 2. Com nosso apoio, os bindings do ROS 2 para Rust estão sendo desenvolvidos (veja em [nosso blog](https://robonomics.network/blog/ros-2-rust-report-2022/)), bem como um [Wrapper do ROS 2](https://github.com/Fingerling42/robonomics-ros2) para usar as principais funções da nuvem descentralizada da Robonomics. Também testamos regularmente dispositivos que suportam o ROS 2, para verificar especificamente nosso software em ação neles. Como um desses robôs, recentemente adquirimos o myBuddy 280 - um manipulador de braço duplo barato para treinamento e pesquisa da [Elephant Robotics](https://www.elephantrobotics.com/en/). O robô pode levantar até aproximadamente 250 gramas e tem um preço de cerca de $1700, tornando-o relativamente acessível para usuários iniciantes.

<RbImage zoom src="/blog/images/automation-home-meets-industrial-mybuddy280/pic_1_myBuddy_280.png" alt="myBuddy 280 dual arm robot manupulator" />

Usando o exemplo deste robô, as vantagens do ROS 2 são muito claramente visíveis, o que permite o uso potencial deste framework em cenários de automação residencial. Em particular, graças ao protocolo de middleware DDS, você pode usar o myBuddy em conjunto com um PC desktop relativamente de alto desempenho e adicionar um robô completo a uma estrutura típica de casa inteligente. Se o robô e o computador estiverem conectados viana mesma rede local e usam o mesmo [DOMAIN_ID](https://docs.ros.org/en/rolling/Concepts/Intermediate/About-Domain-ID.html), podem comunicar sem qualquer configuração adicional. Software básico como drivers e pacotes de descrição de hardware são executados no Raspberry Pi do robô. O restante do software de aplicação necessário, como planejadores de movimento "inteligentes" como o MoveIt, simuladores como o Gazebo, ferramentas de monitoramento e visualização como o RViz, nó Robonomics, aprendizado de máquina, processamento de log em lote, nó de transmissão de dados distribuídos IPFS e outras tarefas que exigem uma quantidade significativa de poder computacional podem ser executados nesta máquina mais poderosa.

Essa disposição permite uma distribuição ótima de recursos computacionais, criando essencialmente uma arquitetura semelhante a microsserviços. Graças à plataforma ROS 2 e ao protocolo de middleware DDS subjacente, essa flexibilidade é possível, permitindo que cada dispositivo execute as tarefas mais adequadas às suas capacidades. Através de mecanismos de detecção automática de dispositivos integrados ao DDS, os tópicos e serviços do ROS 2 encontrarão uns aos outros sem configurações adicionais.

<RbImage zoom src="/blog/images/automation-home-meets-industrial-mybuddy280/pic_2_ros2_dds_smart_home.png" alt="Casa inteligente com ROS 2 e DDS" />

Também deve ser observado que a arquitetura do ROS 2 implica uma separação do protocolo de transporte (como o DDS) em uma camada distinta chamada Middleware ROS, tornando mais fácil alternar de uma implementação de protocolo para outra. Assim, após longas discussões, a comunidade ROS decidiu recentemente mudar para um protocolo mais leve chamado Zenoh, previsto para 2024. Para uma análise mais aprofundada sobre este tópico, recomendamos consultar o [relatório de Alternativas de Middleware do ROS 2](https://discourse.ros.org/uploads/short-url/o9ihvSjCwB8LkzRklpKdeesRTDi.pdf), que contém informações sobre todas as alternativas de DDS consideradas em 2023.

## As Aventuras do myBuddy e Driver Compatível com Robonomics

Apesar do myBuddy 280 ser comercializado como compatível com o ROS 2, descobriu-se que era insuficiente para operação completa no ROS 2 (mesmo sem software de planejamento de movimento como o MoveIt2). Primeiro, tivemos que substituir o modelo Raspberry Pi 4B fornecido por padrão por um mais poderoso com 8 GB de RAM para atender às nossas necessidades. Em segundo lugar, após testar o pacote ROS 2 para myBuddy do fabricante, encontramos problemas. Como é comumNo mundo do código aberto, apenas porque algo é publicado em um repositório público, não garante sua funcionalidade. O robô foi pré-instalado com a distribuição ROS 2 Galactic atualmente não suportada, que expirou em 2022 (aliás, você pode ler sobre os períodos de suporte das distribuições [aqui](https://docs.ros.org/en/rolling/Releases.html)). Apesar de tudo, tentamos executar o robô na distribuição desatualizada e rapidamente encontramos os chamados impasses - um comportamento no qual os subprogramas lançados (ou processos de computação) bloqueiam o trabalho uns dos outros. Após alguma pesquisa, descobrimos que esses erros foram corrigidos na Distribuição LTS do ROS 2 Humble.

Infelizmente, os desenvolvedores da Elephant Robotics pararam de atualizar os pacotes há vários anos e, o que é mais importante, nem todos os pacotes necessários para o robô foram transferidos do ROS 1 para o ROS 2. Portanto, decidimos assumir a tarefa nós mesmos. Devido à falta de disponibilidade da API de baixo nível para o ROS 2, achamos mais fácil desenvolver nossa própria [implementação](https://github.com/Fingerling42/mybuddy280-ros2-robonomics) do pacote ROS 2, onde poderíamos adicionar o controle do myBuddy através do Robonomics. Para isso, pegamos o módulo Python [pymycobot](https://pypi.org/project/pymycobot/) e implementamos nosso próprio driver ROS 2.

O driver personalizado atual pode obter os estados de cada junta para ambos os braços e pulso, bem como enviar ângulos para eles, publicar os estados das juntas do robô usando o datalog do Robonomics e controlar remotamente as juntas enviando uma função de lançamento para o endereço do robô. Se você quiser experimentar, observe que atualizar a versão do ROS 2 reinstalando uma nova imagem com pacotes no Raspberry Pi 4B pode levar uma quantidade significativa de tempo (aproximadamente 2-4 horas).

No futuro, planejamos expandir as funções do driver e fornecer controle remoto deste robô através do Robonomics dentro de nosso laboratório em Chipre. Também queremos incluir o Robonomics ROS 2 Wrapper na lista oficial de pacotes rosdistro, para que os usuários possam instalá-lo automaticamente ao inicializar o projeto ROS 2.

Fique ligado para nossas atualizações!