---
title: "Controle Remoto de Robótica Segura: Solução Robonomics"
date: 2024-04-19
published: true
locale: 'pt'
cover_image: /blog/images/secure-robotics-remote-control-via-web3/remote_control_cover.png
description: "A conexão remota e o controle do seu próprio dispositivo inteligente são recursos muito populares entre os usuários. No entanto, uma tarefa tão trivial ainda causa muitas dificuldades para usuários inexperientes - desde a superação do NAT até questões de segurança. Em um novo artigo, mostraremos como essas dificuldades podem ser superadas com a ajuda da Robonomics."
related: ['Robonomics Helps Enable Rust for ROS 2', 'Automation: Home meets Industrial']
abstract: "A conexão remota e o controle do seu próprio dispositivo inteligente são recursos muito populares entre os usuários. No entanto, uma tarefa tão trivial ainda causa muitas dificuldades para usuários inexperientes - desde a superação do NAT até questões de segurança. Em um novo artigo, mostraremos como essas dificuldades podem ser superadas com a ajuda da Robonomics."
tags: ['ROS 2', 'Casa Inteligente']
---

No artigo anterior, falamos sobre como utilizamos as vantagens de soluções industriais na infraestrutura de uma casa inteligente robotizada. Mostramos como o framework ROS 2 e seu protocolo de middleware fornecem descoberta automática de dispositivos e interação intensiva (inclusive em tempo real) entre eles dentro de uma rede local, o que é muito conveniente. No entanto, essa abordagem é principalmente adequada para a chamada Zona Confiável - aquela parte da rede de computadores onde a presença de atores de terceiros é improvável. Nesse caso, confiamos em todos os programas em execução e não precisamos usar criptografia da mesma forma que não é usada dentro de um único computador quando os programas trocam dados entre si.

Mas e se você precisar garantir o funcionamento de dispositivos ROS 2 com algum serviço externo ou fornecer acesso remoto a eles de fora? Nestes momentos, surge um problema de segurança - ao obter acesso a um nó ROS 2, um serviço externo (e potencialmente uma pessoa maliciosa) essencialmente obtém acesso a todos os outros nós - ele pode ouvir completamente todo o tráfego DDS interno e acessar todos os serviços do sistema disponíveis.

O clássico dilema entre segurança e velocidade/conveniência é resolvido dividindo o sistema de casa inteligente soberano em duas partes - segura e insegura.

## Segurança do ROS 2

Designar uma zona com requisitos de segurança especiais no espaço de trabalho dos nós ROS 2 é uma tarefa bastante não trivial. O pacote de Segurança padrão do ROS 2 ([sros2](https://docs.ros.org/pt/rolling/Concepts/Intermediate/About-Security.html)) faz parte do [ros-core](https://ros.org/reps/rep-2001.html#id32), no qual todas as distribuições do ROS 2 são construídas, e de acordo com os desenvolvedores principais, é destinado a resolver esse problema. Ele fornece a capacidade de configurar uma infraestrutura de chave pública (PKI) relativamente simples dentro de uma única rede local. Para cada nó do ROS 2, são definidas políticas de acesso aos dados de outros nós, bem como um conjunto de arquivos padrão para tais cenários - chaves criptográficas e certificados. Durante a execução do programa, os nós "veem" apenas aquelas fontes de dados às quais o acesso é explicitamente escrito na configuração no estágio de lançamento do projeto. No entanto, essa abordagem tem uma grande desvantagem - todo o tráfego no sistema é criptografado, o que pode afetar o desempenho sob a carga de rede criada pelo DDS. Será necessário escrever todas as políticas de acesso e gerar chaves para todos os nós. Isso é muito difícil de configurar e manter. E, o mais importante, estamos perdendo a principal vantagem do Middleware ROS 2 - desempenho.

## Pontes

Outra solução é criar os chamados gateways, que transmitem os dados necessários mantendo tudo o mais privado. Normalmente, isso é alcançado usando túneis VPN ou SSH. Um nó separado é criado no espaço de troca de dados seguro, que possui um endereço público para conexões externas. Nesse caso, a gestão de segurança é realizada apenas no nível deste nó (essencialmente uma janela para o mundo exterior), sem afetar todos os outros. Esta abordagem é usada nos projetos [Husarnet](https://github.com/husarnet/husarnet), [DDS Router](https://github.com/eProsima/DDS-Router) e [Zenoh Bridge](https://github.com/eclipse-zenoh/zenoh-plugin-ros2dds), mas também tem suas desvantagens. Neste cenário, é necessário estabelecer um canal de comunicação seguro estritamente vinculado ao endereço IP ou nome de domínio da contraparte. Estes podem mudar, ser bloqueados ou ser vulneráveis a ataques. Na época em que o SSH foi criado, isso não foi considerado. Além disso, o SSH depende principalmente do sistema de controle de acesso do sistema operacional, com todas as suas desvantagens inerentes.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/remote_control_legacy_approach.png" alt="Controle Remoto Clássico via IP público e SSH/VPN" />

*Aqui está como os usuários normalmente se conectam aos seus robôs remotamente nos dias de hoje. No entanto, esta abordagem tem algumas desvantagens. Requer um IP público e/ou nome de DNS, que podem ser bloqueados em alguns países. Também exige o armazenamento de chaves privadas adicionais em locais potencialmente inseguros (por exemplo, ~/.ssh).*

O SSH, principalmente usado por administradores de sistema e especialistas em TI, requer conhecimento básico da linha de comando Bash e confiança no sistema operacional, pois as chaves de criptografia são armazenadas diretamente no sistema de arquivos ou no agente SSH. Gerenciar chaves de acesso continua sendo uma tarefa bastante complexa para o usuário médio manter uma maneira segura de proteger seus dados.

## Solução Web3

Como podemos ver, os métodos acima não estão isentos de suas desvantagens, então consideraremos uma possível solução para o problema usando tecnologias de rede peer-to-peer, nas quais o Robonomics é construído. Neste caso, a nuvem descentralizada do Robonomics pode ser vista como uma tabela de roteamento segura, os endereços das contrapartes nas quais são as chaves públicas dos nós. Você precisa de um nó local do Robonomics e conhecimento sobre qual chave pública sua contraparte possui, para não depender do sistema DNS (incluindo registradores de nomes de domínio e servidores) e do bloqueio de endereços IP. A biblioteca [libP2P](https://libp2p.io/), que o Robonomics utiliza, pode usar diferentes protocolos de transporte para entrega de mensagens.

Além disso, com o avanço das tecnologias Web3, surgiram métodos mais eficientes para gerenciar informações críticas, incluindo chaves privadas. Um deles é uma frase mnemônica ou semente - um conjunto de 12 ou 24 palavras, usado para criar contas em redes descentralizadas. Este método é conveniente e seguro, pois a semente é escrita em um meio externo (por exemplo, em papel) uma vez durante a inicialização e é usada apenas para recuperar a conta. Uma chave mestra é criada a partir da frase mnemônica, a partir da qual qualquer hierarquia de chaves para diferentes tarefas pode ser criada (consulte **[Chaves determinísticas hierárquicas](https://docs.substrate.io/reference/command-line-tools/subkey/#hierarchical-deterministic-keys)**). Isso simplifica o gerenciamento de chaves e sua recuperação se forem perdidas. Se uma pessoa maliciosa ganhar acesso a um de seus pares de chaves, ela não poderá obter informações sobre outras chaves criadas a partir da frase mnemônica. A característica de chave derivada suave permite confirmar a propriedade da conta raiz sem divulgá-la. Como as chaves suaves podem ser derivadas usando a chave pública pai, elas podem ser usadas para identificar o pai.chave sem expor a semente pai.

## Controle remoto no Home Assistant

Vamos examinar o processo de conexão com mais detalhes. O aplicativo descentralizado [Robonomics](https://robonomics.app/) (ou apenas DApp) funciona diretamente no seu navegador, não exigindo a instalação de nenhum software adicional ou a necessidade de armazenar chaves no sistema de arquivos em um ambiente com um grande número de programas, cuja segurança você não pode ter certeza. A gestão da chave de acesso é realizada através da extensão Polkadot JS, bem como com a ajuda de um armazenamento de chave de hardware externo (por exemplo, [Polkadot Vault](https://wiki.polkadot.network/docs/polkadot-vault)) para maior confiabilidade. Além do software especializado para interação com Robonomics, o DApp também inclui um nó leve libP2P, com o qual a conexão com o Home Assistant ocorre.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/robonomics_home_assistant_usecase.png" alt="Controle Remoto do Home Assistant" />

O proprietário de uma assinatura do Serviço Web Robonomics gerencia os direitos de acesso à infraestrutura de casa inteligente por meio do que é conhecido como um controlador - uma conta que gerencia todas as informações sensíveis de forma criptografada em um gêmeo digital. Apenas os usuários adicionados à assinatura podem descriptografar esses dados. Além das chaves de acesso, o Gêmeo Digital também armazena a configuração do DApp e, o chamado, endereço multi-libP2P para o qual o DApp se conecta para uma conexão segura. O endereço multi é uma das inovações que torna a abordagem libP2P tão única e flexível. Este é um formato especial de endereço para nós, que implica a presença de muitos endereços IP, identificadores de transporte e rede, protocolos e portas, através dos quais você pode entrar em contato com um nó específico. A lista completa de protocolos suportados está presente na [especificação](https://github.com/multiformats/multiaddr/blob/master/protocols.csv).

Portanto, o usuário adicionado à assinatura extrai um endereço multi do gêmeo digital Robonomics e estabelece uma conexão segura com um ID de Peer conhecido apenas por ele. Sucesso!

## Controle Remoto no ROS 2

Da mesma forma, você pode empregar os recursos existentes da Robonomics para interagir com robôs. A equipe Robossembler, sob o Programa de Subsídio Robonomics, desenvolveu um projeto de Prova de Conceito conhecido como [Robonomics Bridge](https://gitlab.com/robossembler/robonomics_bridge). Esta ponte permiteos seus nós ROS 2 para se conectarem a qualquer serviço externo, estação de trabalho remota ou outro sistema ROS 2.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/robonomics_ros2_usecase.png" alt="Controlo Remoto ROS 2 com Robonomics" />

*Uma ilustração de como o controlo remoto de um robô doméstico pode parecer no caso do ROS 2. Esta abordagem oferece várias vantagens significativas: não é necessário um IP público, o acesso ao robô está disponível mesmo através de firewalls de rede (NAT), as chaves criptográficas privadas não são armazenadas no disco e são protegidas de forma fiável.*

O protocolo utilizado no ROS 2, DDS, combina naturalmente com o libP2P devido ao seu modelo semelhante de publicador-subscritor para interação de nós. Com a ajuda da ponte Robonomics, os nós ROS 2 e as suas interfaces - tópicos, serviços, tipos de mensagens (por exemplo, usando o Serviço de Integração eProsima) podem ser configurados de forma declarativa, através dos quais a interação com o robô a partir do exterior é possível. Isso também permite um nível adicional de segurança ao conectar-se a um computador remoto. O mecanismo para obter o PeerID da contraparte pode ser o mesmo que no caso do Home Assistant - através de um pedido de Gémeo Digital do nó Robonomics, com a única diferença sendo que em vez do Servidor Home Assistant haverá um robô ROS 2, e em vez do libP2P-websocker-proxy haverá um Invólucro Robonomics ROS 2 conectado ao robô.

## Oportunidades potenciais no futuro

No entanto, estas não são todas as possibilidades que uma nuvem descentralizada em tecnologias Web3 pode oferecer. No exemplo descrito acima, essas tecnologias são usadas para a transmissão relativamente simples de fluxos de dados de mensagens entre computadores remotos.

Isso pode ser chamado de nível de transporte básico na pilha de rede Robonomics, que é a base para a implementação de protocolos de níveis superiores mais complexos. Começando pelos análogos de SSH, implicando uma interação mais interativa dos utilizadores com os seus sistemas ciberfísicos, e terminando com protocolos de aplicação que implicam a interação de um grande número de utilizadores de infraestrutura robótica autónoma.

Por exemplo, a decisão de iniciar a produção de um determinado produto pode estar ligada a uma votação dentro de uma organização de potenciais consumidores desse produto, considerando a viabilidade económica. Atualmente, a decisão de iniciar qualquer produção é tomada através de mecanismos de investimento, onde os investidores, tendo recebido informações sobre a procura potencial, podem adquirir ações de empresas individuais que possam satisfazer essa procura no futuro.Se os consumidores puderem participar mais ativamente no desenvolvimento e precificação de novos produtos, então a longo prazo podemos mudar para um modo de operação no qual a produção se reestruturará automaticamente para atender à demanda de acordo com os dados fornecidos pelos consumidores na rede.