---
title: 机器人学 Web3 DevOps 技术栈
date: 2024-06-12
published: true
locale: 'zh'
tags: ['DevOps', 'Web3']
cover_image: /blog/images/web3-devops-stack/web3-devops-stack-Cover.png
description: "DevOps 运动已经彻底改变了IT世界，并重新塑造了我们对有效、持续系统改进的理解。机器人领域刚开始探索这种方法。在本文中，我们设想了使用 Web3 技术为机器人实现 DevOps 的潜在未来。我们还重点介绍了一些可能为这一未来奠定基础的项目。"
abstract: "DevOps 运动已经彻底改变了IT世界，并重新塑造了我们对有效、持续系统改进的理解。机器人领域刚开始探索这种方法。在本文中，我们设想了使用 Web3 技术为机器人实现 DevOps 的潜在未来。我们还重点介绍了一些可能为这一未来奠定基础的项目。"
---

## 开发与运维的起源

作为能够移动和感知外部世界的设备，机器人是计算机的一个特殊案例。正如工程师们经常说的那样，飞机是一台飞行的计算机，强调了机载计算设备对维持这个物理系统的可行性的重要性。因此，我们可以看看信息系统领域在21世纪是如何发展的，并确定一些趋势，这些趋势将在不久的将来成为机器人领域的固有特征。

软件及其开发所使用的实践显著改变了工程和任何其他活动的工作方法。首先，这些变化影响了所谓的瀑布模型方法，当时任何项目被视为一系列漫长的交替阶段：需求 - 开发 - 验证 - 验证 - 运行。随着时间的推移，人们发现，将项目划分为阶段对管理者来说很方便，但并不完全符合生活中的实际情况，并且在不断变化的外部世界条件下，产品的快速适应变得更加复杂。敏捷方法论暗示着在项目上同步工作，并具有较小的计划间隔，取代了瀑布模型的活动（和管理）。与具有里程碑的大阶段不同，敏捷方法论采用了小的冲刺和增量 - 开发系统中的小但频繁变化，并快速发布。如果发布伴随着复杂的行政程序和手动检查，那么这样的工作节奏是无法达到的。因此，开发与运维运动应运而生，以实施将价值从开发者传递给消费者的实践，而无需损失，并创造了一个新的职业，即 DevOps。运维工程师，自动化快速启动系统的流程。

![devops origins](/blog/images/web3-devops-stack/devops-evolution.png)

这些实践包括自动化测试、持续集成、交付、部署和软件监控。自动化测试用于检查错误，而持续集成频繁集成代码更早地检测问题。交付和部署涉及将软件提供给用户并在其环境中安装。

最初，这些实践在大型网络服务领域获得了动力，这些服务为全球数百万用户提供服务。在这样的背景下，这些实践对于保持这些服务所期望的高性能和可靠性至关重要。然而，随着时间的推移，自动化工具变得更加易于获取（部分原因是开源贡献），DevOps开始在更传统类型的工程活动中使用。因此，这些实践已经超越了它们最初的领域，现在被应用于各个领域，以提高软件产品的效率、可靠性和质量。

## 机器人在DevOps背景下的关键特点

机器人与静止服务器和数据中心不同，它们在空间中移动并感知外部环境。越来越多这样的设备正在出现。我们看到它们的计算能力随着时间的推移而增长 - 许多技术解决方案如果没有强大的机载处理器将根本不可能实现。

随着边缘计算的增加，即在移动设备上进行计算，使用DevOps变得更加流行。这种方法允许快速将新开发的功能交付给消费者。机器人可以持续连接到网络，并使用Docker和其他在实践中被证明有效的工具及时更新其软件。

然而，额外的功能也带来了额外的风险 - 通过赋予计算机与外部环境和互联网同时进行密集交互的能力，我们为这些设备可能造成的潜在危害创造了前提，如果它们落入恶意分子控制之下。智能设备逐渐填满我们的家，却可能突然发疯！在一个不断变化的世界中，安全问题至关重要，因为所有这些设备都与我们的身体密切接触。错误可能代价高昂。

是什么让机器人与其他计算机不同？这些特殊功能包括：

1. 各种硬件平台（与相对较少的中央处理器架构类型相比）
2. 在不可预测的环境中工作，这意味着存在紧急情况 - 例如，通信渠道不可用
3. 机载计算设备的资源有限 - 弱处理器、相对较小的内存量和低网络带宽4. 增加的安全要求
5. 需要更新和新增功能的大量设备

考虑到这些限制，我们将尝试基于Web3技术为机器人制定DevOps的概念基础，至少用于编写代码、构建和部署。我们将尝试展示最有趣的Web3项目，这些项目能够确保去中心化DevOps传送带的运行，并展示Robonomics如何在生命周期的最后阶段——在将程序实施到外部世界时成为其中不可或缺的一部分。

## Web3和区块链

当我们谈论Web3时，我们主要指的是区块链技术。当然，这些概念密切相关，但并非完全相同。通常在这个概念下，暗示了一整套技术——椭圆曲线加密、P2P网络、共识算法。前两点并不是什么独特的东西，在IT行业被广泛使用，而最后一个确实赋予了区块链一种特殊功能，使这个解决方案成为一个强大的工具。但是我们是否需要在所有生活情况（以及DevOps传送带的各个部分）中都需要共识呢？让我们试着弄清楚。

共识在不同的背景下有不同的含义，但其本质始终不变——组成去中心化网络的系统、参与者或自治代理达成一致，就使用哪种协议进行工作以及共同数据的状态达成一致。如果各方无法达成一致，这将导致所谓的分叉。历史上，分叉意味着区块链的分裂，导致网络节点分为两部分——一些节点仍然“忠诚”于旧版本的协议，而其余节点则切换到新版本。这一事件总是带有负面的背景——社区在减少而不是巩固，这使得项目在某种程度上变得更脆弱。同时，就像在生物进化中一样，以及我们现在观察到的技术版本中，分支不断发生，并且导致新生命形式的出现。看看生命之树。树上的每个分支都是在古代发生的分叉——一次突变诞生了一个与同类不兼容的新物种。没有这种机制，现代生命的理解将是不可能的。有机体突变的能力使它们能够适应不断变化的环境条件。

因此，我们得出结论，共识既是好事，因为它允许协调许多行为者和可伸缩性，但同时也有不好的一面，因为它阻碍了新事物的出现，那些偏离共识的人总是被视为局外人，系统会把他们“推”出去。

与生物进化不同，我们人类进行技术进化，这取决于我们如何进行这种进化。技术中的突变源于工程师，他们运用科学方法和创造性思维来生产新的、更有前景和可行性的技术版本。我们从更频繁的突变中受益，我们从在生成新有效解决方案的领域中分散化中受益。相反，一种情况是一个观点“获胜”，并且达成完全无条件的共识，这在某些情况下可能会导致崩溃的风险。这就是为什么自然没有选择创建像行星大小的超级生物体，而是选择了分散化的方式——当所有生物都分散在生态位和生态系统中时，这使得整体生活稳定，甚至根据[雏菊世界模型](https://en.wikipedia.org/wiki/Daisyworld)稳定了地球（简而言之，由于生物圈及其多样性，行星变得更加稳定）。

那么，为什么要这样离题？主要是为了强调并非所有数据都需要强制共识，这使得区块链不适用于每种情景。当不协调的行动可能导致不可逆转的后果时，共识变得必要。例如，在道路交叉口上就至关重要。如果关于何时前行何时停止的交通规则没有达成一致，你可以想象潜在的混乱！

回到文章的主题，可以假设在风险较高的情况下共识是合适的，反之，在风险较小的情况下，更适合选择一个完全没有共识的分散化系统。代码开发本身是一个相对安全的活动，只要它保持在源代码状态，甚至是在构建服务器上的可执行文件状态。然而，当涉及将这些文件部署到现实世界的物理基础设施时，保持一致性就变得非常重要。这就是为什么对于我们DevOps堆栈的前两个阶段（开发和构建），我们选择了没有共识的志同道合的项目。

## 第一阶段 - 开发 - Radicle

![](/blog/images/web3-devops-stack/1st-phase-development.png)

因此，在代码开发中，需要完全的自由和分散化来刺激从作者直接生成最佳解决方案。幸运的是，在代码开发行业，事实上的标准已经成为一种分散式设计的版本控制系统。我当然是在谈论git。git的先验并不意味着存在单一的“真相源” - 任何用户在使用代码之前都需要将存储库克隆到他们的计算机上，并使用他们的本地副本进行工作。此外，git中的数据存储方法实际上只是一系列块（代码更改的固定事实 - 提交），这保证了历史的不可变性。也就是说，git本身是一种区块链，通过作者自己通过分支和合并请求手动实现共识。

尽管git具有分散式的特性，但Web2平台已经占据了它们的位置。现在，代码开发几乎完全集中在一小部分平台上，如Github、Bitbucket、Gitlab。这正是因为引入了额外的工具：DevOps（CI/CD流水线、内置功能用于检测源代码依赖项中的漏洞等）和社交网络（开发者奖励系统、问题跟踪、项目管理）。这些工具不是原始git协议的一部分，而且使项目从一个平台迁移到另一个平台变得复杂。

项目[Radicle](https://radicle.xyz/)是专门为了让代码开发人员摆脱对大型平台的依赖而成立的，我们认为这是我们的Web3-DevOps堆栈的第一个组成部分。该项目有着相当[悠久的历史](https://docs.radworks.org/community/our-story)，并在发展过程中经历了许多重大变革。最初，Radicle是建立在当时日益流行的星际文件系统（IPFS）之上的，但在某个时刻，开发人员意识到在IPFS中存储和散列代码存储库数据的方式与在git中存储的方式不兼容，导致信息重复和即使在小更新的情况下也会消耗过多的流量。逐渐地，他们决定转向更为简约的解决方案 - 直接交换git补丁，使用本机[pack协议](https://git-scm.com/docs/pack-protocol/en)，使其成为“代码保管者”网络中数据传输的主要方式。这一决定标志着项目从Go语言重构和改写为Rust的开始。这个新版本的协议被称为Heartwood，受到项目如Secure Scuttlebutt (SSB)和比特币的[闪电网络](https://en.wikipedia.org/wiki/Lightning_Network)的启发。

随后，在2021年，去中心化自治组织（简称DAO）Radworks在以太坊区块链上成立，发行了RAD治理代币，并筹集了进一步发展项目所需的资金。显然，项目团队并不否认社会和经济因素在代码开发中的重要性，但同时也不试图将所有支持工具整合到他们的实施中。其中一个这样的倡议是他们的项目和同名智能合约[Drips](https://www.drips.network/)，旨在自动将捐款在开源开发者之间分配，口号是“资助您的依赖项”。在这个智能合约中，每个开发项目都可以设置接收到的捐款的自动重新分配，用于其依赖项（包、库）的集合。

就在最近的2024年3月，Heartwood协议实现的1.0.0版本发布了，这意味着它已经可以考虑用于去中心化开发流水线的生产场景。

## 第二阶段 - 构建、测试、持续集成 - Fluence

![web3构建软件](/blog/images/web3-devops-stack/2nd-phase-build.png)

我们简化的DevOps流水线中的下一步是构建阶段，这不仅包括代码编译。它涉及一系列具有不同计算资源强度的过程。然而，这些计算并不总是导致有形的变化。换句话说，并非每次代码更改或构建启动都会导致发布。通常，持续集成（CI）流水线按计划运行。它们产生的构件通常是短暂的，如果未包含在发布中，则会被删除。因此，我们不认为开发生命周期中的这个阶段需要共识，类似于许多使用区块链进行结果验证的云计算项目。

[Fluence](https://fluence.dev/)的开发人员持有类似的立场。这是一个与Robonomics非常接近的项目，它还在其用例中密集使用libP2P作为传输层，ipfs作为存储层，同时专注于对等体的编排和计算，而无需中心化平台。让我们更仔细地看看它们。

Fluence由两个关键组件组成 - Aqua和Marine。前者是一种特定领域语言（DSL），用于管理任务序列。在计算设备上，即编排对等体。一方面，掌握另一种语言可能会阻碍许多用户，另一方面，这是一个诚实的步骤，立即为不可避免的未来做好准备。事实上，大多数 CI 平台通常提供一些常见格式的配置文件，如 YAML 或 JSON，用于管理和设置流水线。起初，这确实很方便，允许任何没有编程技能的用户开始工作，但随着需求和相应的配置数量增长，缺乏程序员熟悉的工具导致样板代码的增长和无法管理复杂性。试图使用模板将 YAML 变成配置语言也无法解决问题，这促使出现了像 HCL（HashiCorp 配置语言）这样的临时配置描述语言。Aqua 提供了一种即时解决方案，即一种用于计算流的应用程序编程语言，它在 Pi-演算的可靠理论基础上编译 Aqua 代码，以便在对等体上进一步执行。这使得进入该技术的门槛略高一些，但理想情况下应该在未来提供更稳定和可维护的工作。现在 Aqua 是一种相当低级的语言，但随着时间的推移，可能会出现实现使用方便的数学抽象设计计算流的最佳实践的库，这将加快分布式计算的开发速度。

Aqua 设置了计算的顺序，但计算本身是使用 Marine 准备和执行的 - 这也是由 Fluence 开发的组件。Marine 是一个 SDK（软件开发工具包）- 一组用于组装相互兼容的 Webassembly 模块的工具，以及一个 Runtime - 用于它们执行的通用环境。模块是相对独立的软件组件，每个模块都保存自己的状态，但可以通过函数导入/导出相互交互。一组互动的模块形成一个服务，该服务实现复杂行为，并在 Fluence 对等体网络中作为参与者。

总的来说，Aqua 和 Marine 充分提供了可以称之为智能物理系统思维的内容 - 即帮助做出关于在外部世界采取什么行动以增加在进化竞争中成功机会的各种计算。

[基于模型的](https://en.wikipedia.org/wiki/Model-based_systems_engineering)机器人开发需要资源密集型计算。开发的机器人软件的大部分测试在模拟器中进行，基于强化学习的算法在这些虚拟环境中启动数十万次。许多次才能实现所需的代理行为。各种物理和渲染引擎以及基于它们的游戏引擎可以作为虚拟环境。最近，实体组件系统设计模式在这些环境中变得普遍。顺便说一句，Open Robotics 的著名机器人模拟器 Gazebo/ex-Ignition 的现代版本（他们也开发 ROS）也[使用 ECS](https://gazebosim.org/docs/harmonic/architecture)来提高性能和灵活性。事实上，根据Fluence的开发人员，他们的执行模型非常适合基于这一原则构建的分布式架构的实现。

当然，为了使经过编译和测试的软件产生价值，必须部署在硬件平台上。从假设的角度来看，也可以使用Fluence部署软件。事实上，开发人员自己说他们的技术栈也允许在对等体上部署，这确实是事实。然而，我们认为在与外部环境和物理设备交互的领域，需要共识是必要且重要的。

## 第三阶段 - 部署 - Robonomics

![robotics deployment art](/blog/images/web3-devops-stack/3rd-phase-deploy.png)

软件的一个重要特征是它本身不会改变外部世界，而是作为周围现实的模型，并帮助对其进行推理 - 提出假设，提出行动计划，在外部世界中使用设备或人员启动流程。例如，问题跟踪器本身并不是一个改变外部世界的系统，它可以被称为开发团队的数字孪生体，而后者又将变化带入现实生活。通过问题跟踪器，团队可以相互协调行动，互相帮助。换句话说，问题跟踪器允许在开发团队内保持共识 - 谁做什么任务以及何时做 - 但变化本身是由人来实现的。

在讨论改变世界的系统时，我们指的是在现实世界中运作的物理实体，如智能设备、机器人和自动工厂。基本上，Robonomics 作为信息系统和人员与通过机器人系统连接到外部世界的桥梁。安全性的重要性不言而喻，因为忽视安全性不仅可能导致资本损失，还可能导致真正的灾难。

尽管这些系统的重要性不言而喻，但第一个安全的去中心化存储系统出现在金融领域而不是工业领域。银行账户被证明是计算机犯罪分子更感兴趣的目标是家用电器，其中大多数缺乏网络连接。用于保护银行信息系统的技术已经显著发展，从 SWIFT 到 Ethereum，现在逐渐被应用于其他经济领域。

Robonomics 处于这些安全、去中心化网络的前沿，负责 Web3 DevOps 传送带的最后阶段 - 部署。

一般来说，部署是将系统投入运行。这个术语的一个更常见的同义词是安装 - 在此之后，生产和交付的系统（某种类型设备的实例，软件的可执行文件）开始在更高级系统内运行。在这种情况下，区块链的好处是什么？首先，当向外界发布任何程序版本时，对于我们来说，了解到底发布了什么是非常重要的。在开发过程中，版本可能会经常更改，这是正常的，因此不建议将所有关于它们的信息都放在区块链上。然而，发布或启动事件需要固定，这样在收到反馈时，我们可以清楚地了解需要将此反馈与哪个确切版本的源代码或图纸进行比较。区块链可以作为连接到其上的设备的所有软件更新信息的可靠存储库。

此外，安装过程必须一致，因为不一致可能导致配置冲突。这些冲突可能来自不匹配的软件模块版本、在同一空间内部署不同系统以及其他相关问题。例如，先前提到的在无规则交叉口发生的车辆碰撞就是这种冲突的一个例子。在软件部署的背景下，冲突可能表现为 API 违规、硬件能力不足或写入被禁止或不安全的内存位置。Robonomics 可以存储连接设备的配置，并在共识算法级别防止这种状态。

您可以使用特殊的 [launch](https://wiki.robonomics.network/docs/launch/) 调用在 Robonomics 平行链中部署软件，这允许您启动连接到区块链的节点，并附加参数。参数可以是 IPFS 内容分发网络中的唯一标识符，从中您可以获取软件镜像、二进制文件、操作系统配置的源代码，甚至是一个 bash 脚本！由于网络中的每个交易都使用加密密钥签名，因此在平行链中进行这样的调用实质上等同于公共发布签名。

对于更复杂的场景，您可以使用一个 [digital twin](https://wiki.robonomics.network/docs/digital-twins/), 允许在任意数据256位长和Robonomics网络中的帐户之间建立对应表。因此，您可以为Robonomics网络中设备帐户的配置版本更改保留日志。在传统的配置和部署系统中，主机通常被指定为节点 - 这些是具有DNS名称或IP地址的计算机。在Web3的情况下，主机通过其公共加密密钥进行识别，这些密钥与帐户相关联。要更改配置，可以添加一个新的内容标识符，从中设备将接收软件的新版本并进行更新。

## 将所有内容整合在一起

![web3 devops stack](/blog/images/web3-devops-stack/devop-stack-full-art.png)

因此，让我们试着从鸟瞰的角度来看待这个问题。人们构成了我们庞大的网络物理系统的核心。人类是混乱的、不可预测的...而这是好事！他们产生新的含义、想法、产品。他们实现了改变世界的意愿。如今，在21世纪，不再需要亲自动手改变世界。人类面临的任务并不适合人类的双手。相反，有机器，现在作为我们意志的传导体。机器则是严格确定性和可预测性的。人们喜欢这一点，是的。他们喜欢火车准时到达车站，他们消费的产品质量总是可预测地优秀。为此，人们使用网络。大量的网络！他们在Radicle网络上生成想法，机器将其收集并测试成可执行模块在Fluence网络上，然后在Robonomics网络上部署它们到机器人上。机器人反过来改变环境，他们的传感器也通过Robonomics向人们提供反馈以做出决策 - 这个循环是闭合的。这是一个持续改进的循环，每个人都有自己的位置。机器和人之间没有矛盾 - 他们和谐地创造了人类的新秩序 - 星际人类。