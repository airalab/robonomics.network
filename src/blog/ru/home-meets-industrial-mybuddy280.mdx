---
title: "Автоматизация: Дом встречает Промышленность"
date: 2024-03-24
published: true
locale: 'ru'
cover_image: /blog/images/automation-home-meets-industrial-mybuddy280/Cover.png
description: "ROS 2 - это фреймворк, который быстро становится популярным для разработки робототехнических приложений. Он включает в себя накопленный опыт отрасли и делится им с мировым сообществом. Наша команда активно участвует в разработке новых пакетов ROS 2 для используемых нами роботов, а также интегрирует их в децентрализованную сеть Robonomics."
related: ['Robonomics Helps Enable Rust for ROS 2']
abstract: "ROS 2 - это фреймворк, который быстро становится популярным для разработки робототехнических приложений. Он включает в себя накопленный опыт отрасли и делится им с мировым сообществом. Наша команда активно участвует в разработке новых пакетов ROS 2 для используемых нами роботов, а также интегрирует их в децентрализованную сеть Robonomics."
tags: ['ROS 2', 'Умный дом']
---

Технологии, разработанные в одной отрасли, часто находят широкое применение в других отраслях, даже если изначально не были предназначены для них. Так, интернет, изначально разработанный для военных целей, раскрыл свой полный потенциал в гражданской сфере, став неотъемлемой частью современной жизни. Подобная тенденция может проявиться и в промышленности, где технологии, разработанные для предприятий, также могут приносить пользу конечным пользователям.

Исторически домашняя автоматизация и промышленная робототехника развивались по-отдельности. Из-за высокой стоимости и проблем безопасности промышленные роботы в основном ограничивались крупномасштабным производством. Программное обеспечение для управления производством оставалось в рамках проприетарных систем выполнения производства и систем компьютерного управления производством. Домашняя автоматизация в то же время обычно представляла собой систему довольно простых устройств для взаимодействия с гаджетами пользователя, бытовой техникой, освещением, отоплением, связью. Акцент в связи делался на беспроводной связи.

Однако мы видим тенденции. С одной стороны, беспроводные протоколы связи из сферы потребления постепенно адаптируются для промышленных приложений — например, появляются промышленные версии Wi-Fi или Bluetooth. С другой стороны, манипуляторные роботы становятся более доступными и начинают рассматриваться для использования за пределами промышленности. Уже сейчас мы можем размышлять о том, как в будущем, например, безопасные совместные роботы станут неотъемлемой частью дома и смогут сделать нашу жизнь более удобной, помогая в готовке и других рутинных домашних делах. Также существуют реализации промышленных протоколов связи с открытым исходным кодом — такие как протокол промежуточного слоя DDS подзакрепление фреймворка ROS 2 — становится наследием энтузиастов со всего мира.

ROS 1 был разработан для управления одним роботом и не мог удовлетворить требования производственных предприятий: работа в реальном времени, отказоустойчивость в нестабильных условиях связи, взаимодействие с большим количеством устройств. Так началось развитие ROS 2, который изначально позиционировался специально под потребности промышленности и теперь становится основным в робототехнике. В середине 2023 года произошло важное событие — спустя 5 лет после появления ROS 2 Dashing в 2019 году, количество пакетов ROS 2, используемых инженерами, согласно [metrics.ros.org](https://metrics.ros.org/packages_rosdistro.html), превысило количество пакетов ROS 1, и теперь около 70% программных пакетов, загружаемых из официальных репозиториев, предназначены для ROS 2.

## Преимущества ROS 2 для сценариев домашней автоматизации

Команда Robonomics на передовой этого процесса и активно поддерживает сообщество ROS 2. При нашей поддержке разрабатываются привязки ROS 2 для Rust (см. [наш блог](https://robonomics.network/blog/ros-2-rust-report-2022/)), а также [обертка ROS 2](https://github.com/Fingerling42/robonomics-ros2) для использования основных функций децентрализованного облака Robonomics. Мы также регулярно тестируем устройства, поддерживающие ROS 2, чтобы специально проверить работу нашего программного обеспечения на них. В качестве одного из таких роботов мы недавно приобрели myBuddy 280 — недорогой двуручный манипулятор для обучения и исследований от [Elephant Robotics](https://www.elephantrobotics.com/en/). Робот может поднимать до приблизительно 250 грамм и стоит около $1700, что делает его относительно доступным для новичков.

<RbImage zoom src="/blog/images/automation-home-meets-industrial-mybuddy280/pic_1_myBuddy_280.png" alt="двуручный робот myBuddy 280" />

На примере этого робота очень ясно видны преимущества ROS 2, которые позволяют потенциально использовать этот фреймворк в сценариях домашней автоматизации. В частности, благодаря протоколу промежуточного слоя DDS, вы можете использовать myBuddy в сочетании с относительно производительным настольным ПК и добавить полноценного робота в типичную структуру умного дома. Если робот и компьютер связаны черезесли устройства находятся в одной локальной сети и используют тот же [DOMAIN_ID](https://docs.ros.org/ru/rolling/Concepts/Intermediate/About-Domain-ID.html), они могут общаться без дополнительной конфигурации. Основное программное обеспечение, такое как драйвер и пакеты описания оборудования, работает на Raspberry Pi робота. Остальное необходимое приложение, такое как "умные" планировщики движения, например MoveIt, симуляторы, такие как Gazebo, инструменты мониторинга и визуализации, такие как RViz, узел Robonomics, машинное обучение, обработка пакетов журналов, узел передачи данных IPFS и другие задачи, требующие значительных вычислительных ресурсов, могут быть запущены на этом более мощном устройстве.

Такая организация позволяет оптимально распределить вычислительные ресурсы, фактически создавая архитектуру, подобную микросервисам. Благодаря платформе ROS 2 и базовому протоколу промежуточного уровня DDS, эта гибкость возможна, позволяя каждому устройству выполнять задачи, наилучшим образом подходящие для его возможностей. Благодаря встроенным механизмам автоматического обнаружения устройств в DDS, темы и сервисы ROS 2 будут находить друг друга без дополнительных настроек.

<RbImage zoom src="/blog/images/automation-home-meets-industrial-mybuddy280/pic_2_ros2_dds_smart_home.png" alt="Умный дом с ROS 2 и DDS" />

Также следует отметить, что архитектура ROS 2 предполагает разделение протокола передачи (например, DDS) на отдельный уровень, называемый ROS Middleware, что упрощает переход от одной реализации протокола к другой. Таким образом, после длительных обсуждений сообщество ROS недавно решило перейти к более легкому протоколу под названием Zenoh, который запланирован на 2024 год. Для более подробного изучения этой темы рекомендуем обратиться к [отчету о альтернативах промежуточного ПО ROS 2](https://discourse.ros.org/uploads/short-url/o9ihvSjCwB8LkzRklpKdeesRTDi.pdf), который содержит информацию обо всех рассматриваемых альтернативах DDS в 2023 году.

## Приключения myBuddy и совместимый с Robonomics драйвер

Несмотря на то, что myBuddy 280 был анонсирован как совместимый с ROS 2, оказалось, что он недостаточен для полноценной работы в ROS 2 (даже без программного обеспечения для планирования движения, такого как MoveIt2). Во-первых, нам пришлось заменить поставленную по умолчанию модель Raspberry Pi 4B на более мощную с 8 ГБ оперативной памяти, чтобы удовлетворить наши потребности. Во-вторых, после тестирования пакета ROS 2 для myBuddy от производителя у нас возникли проблемы. Как это обычноВ мире открытого исходного кода публикация в общедоступном репозитории еще не гарантирует его функциональность. Робот был предустановлен с неподдерживаемым на данный момент распределением ROS 2 Galactic, которое истекло в 2022 году (кстати, вы можете прочитать о периодах поддержки распределений [здесь](https://docs.ros.org/en/rolling/Releases.html)). Несмотря на все, мы попытались запустить робот на устаревшем распределении и быстро столкнулись с так называемыми тупиками — такое поведение, при котором запущенные подпрограммы (или вычислительные процессы) блокируют работу друг друга. После некоторых исследований мы выяснили, что эти ошибки были исправлены в LTS-распределении ROS 2 Humble.

К сожалению, разработчики Elephant Robotics прекратили обновление пакетов несколько лет назад, и, что более важно, не все необходимые пакеты для робота были перенесены с ROS 1 на ROS 2. Поэтому мы решили взять эту задачу на себя. Из-за недоступности низкоуровневого API для ROS 2, мы нашли проще разработать собственную [реализацию](https://github.com/Fingerling42/mybuddy280-ros2-robonomics) пакета ROS 2, где мы могли добавить управление myBuddy через Robonomics. Для этого мы взяли модуль Python [pymycobot](https://pypi.org/project/pymycobot/) и реализовали собственный драйвер ROS 2.

Текущий пользовательский драйвер может получать состояния каждого сустава для обеих рук и запястья, а также отправлять углы на них, публиковать состояния суставов робота с использованием журнала данных Robonomics и удаленное управление суставами, отправляя функцию запуска на адрес робота. Если вы хотите попробовать, обратите внимание, что обновление версии ROS 2 путем переустановки нового образа с пакетами на Raspberry Pi 4B может занять значительное количество времени (приблизительно 2-4 часа).

В будущем мы планируем расширить функционал драйвера и обеспечить удаленное управление этим роботом через Robonomics в нашей лаборатории на Кипре. Мы также хотим включить обертку Robonomics ROS 2 в официальный список пакетов rosdistro, чтобы пользователи могли устанавливать ее автоматически при инициализации проекта ROS 2.

Следите за нашими обновлениями!