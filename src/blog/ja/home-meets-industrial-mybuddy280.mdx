---
title: "自動化：家庭と産業の融合"
date: 2024-03-24
published: true
locale: 'ja'
cover_image: /blog/images/automation-home-meets-industrial-mybuddy280/Cover.png
description: "ROS 2は、ロボティクスアプリケーションの開発に急速に人気を集めているフレームワークです。これには、業界の蓄積された経験が含まれ、グローバルコミュニティと共有されています。私たちのチームは、使用するロボットのための新しいROS 2パッケージの開発に積極的に関与しており、それらを分散型のRobonomicsネットワークに統合しています。"
related: ['Robonomics Helps Enable Rust for ROS 2']
abstract: "ROS 2は、ロボティクスアプリケーションの開発に急速に人気を集めているフレームワークです。これには、業界の蓄積された経験が含まれ、グローバルコミュニティと共有されています。私たちのチームは、使用するロボットのための新しいROS 2パッケージの開発に積極的に関与しており、それらを分散型のRobonomicsネットワークに統合しています。"
tags: ['ROS 2', 'スマートホーム']
---

ある産業で開発されたテクノロジーは、元々そのために設計されていなくても、他の産業に広く適用されることがよくあります。そのため、軍事用に開発されたインターネットは、市民の領域でその真の可能性を示し、現代生活の重要な一部となりました。同様の傾向が産業界でも起こる可能性があります。企業向けシナリオ向けに開発されたテクノロジーがエンドユーザーにも利益をもたらすことができるのです。

歴史的に、ホームオートメーションと産業用ロボティクスは別々に進化してきました。高額で安全上の懸念があるため、産業用ロボットは主に大規模生産に限定されてきました。生産管理のためのソフトウェアは、独自の製造実行およびコンピュータ支援製造システム内に閉じ込められていました。一方、ホームオートメーションは、ユーザーガジェット、家電製品、照明、暖房、通信とのやり取りのための比較的シンプルなデバイスシステムを表していました。通信においては、無線通信が重視されていました。

しかし、トレンドが見られます。一方で、消費者領域からの無線通信プロトコルが徐々に産業用途に適応されつつあります — たとえば、産業用のWi-FiやBluetoothのバージョンが登場しています。他方で、マニピュレーターロボットは手頃な価格であり、産業以外の用途にも考慮されるようになっています。今でも、将来的には、例えば安全な協働ロボットが家庭の重要な一部となり、料理やその他の日常家事で私たちの生活をより便利にしてくれる様子を考えることができます。また、DDSミドルウェアプロトコルなどの産業用通信プロトコルのオープンソース実装も、現在では産業界だけでなく、家庭でも利用される可能性があります。ROS 2フレームワークの普及は、世界中の愛好家たちの遺産となっています。

ROS 1は単一ロボットの管理用に開発されましたが、製造企業の要件を満たすことができませんでした：リアルタイム動作、不安定な通信状況における障害耐性、多数のデバイスとの相互作用。そのため、ROS 2の開発が始まり、当初は産業のニーズに特化していましたが、現在はロボティクスの主流となっています。2023年の中頃、重要なイベントが発生しました - 2019年にROS 2 Dashingが登場してから5年後、エンジニアが使用するROS 2パッケージの数がROS 1パッケージを上回り、現在、公式リポジトリからダウンロードされるソフトウェアパッケージの約70%がROS 2用です。

## ホームオートメーションシナリオ向けのROS 2の利点

Robonomicsチームはこのプロセスの最前線におり、積極的にROS 2コミュニティを支援しています。私たちの支援により、Rust向けのROS 2バインディングが開発されています（[当社のブログ](https://robonomics.network/blog/ros-2-rust-report-2022/)をご覧ください）、また、Robonomics分散型クラウドの主要機能を使用するための[ROS 2ラッパー](https://github.com/Fingerling42/robonomics-ros2)も開発されています。また、ROS 2をサポートするデバイスを定期的にテストし、ソフトウェアがそれらで正常に動作するかを確認しています。最近、そのようなロボットの1つとして、[Elephant Robotics](https://www.elephantrobotics.com/en/)から購入したmyBuddy 280という安価なデュアルアームマニピュレーターを取得しました。このロボットは約250グラムまで持ち上げることができ、約$1700で購入でき、初心者には比較的手頃な価格です。

<RbImage zoom src="/blog/images/automation-home-meets-industrial-mybuddy280/pic_1_myBuddy_280.png" alt="myBuddy 280デュアルアームロボットマニピュレーター" />

このロボットの例を使って、ROS 2の利点は非常に明確になり、このフレームワークをホームオートメーションシナリオで活用する可能性があります。特に、DDSミドルウェアプロトコルのおかげで、myBuddyを比較的高性能なデスクトップPCと組み合わせて、典型的なスマートホーム構造に完全なロボットを追加することができます。ロボットとコンピュータがリンクされている場合、同じローカルネットワークを使用し、同じ[DOMAIN_ID](https://docs.ros.org/ja/rolling/Concepts/Intermediate/About-Domain-ID.html)を使用している場合、追加の設定なしで通信できます。ドライバーやハードウェアの説明パッケージなどの基本ソフトウェアは、ロボットのRaspberry Piで実行されます。"スマート"な移動プランナーであるMoveIt、Gazeboのようなシミュレータ、RVizのような監視および可視化ツール、Robonomicsノード、機械学習、バッチログ処理、IPFS分散データ伝送ノードなど、大量の計算リソースを必要とするその他のタスクに必要なアプリケーションソフトウェアの残りは、このより強力なマシンで実行できます。

この配置により、計算リソースの最適な分配が可能となり、実質的にマイクロサービスのようなアーキテクチャが作成されます。ROS 2プラットフォームと基盤となるDDSミドルウェアプロトコルのおかげで、この柔軟性が実現され、各デバイスが自らの能力に最適なタスクを実行できます。DDSに組み込まれた自動デバイス検出メカニズムにより、ROS 2のトピックとサービスは追加の設定なしで互いを見つけることができます。

<RbImage zoom src="/blog/images/automation-home-meets-industrial-mybuddy280/pic_2_ros2_dds_smart_home.png" alt="ROS 2とDDSを使用したスマートホーム" />

また、ROS 2のアーキテクチャは、トランスポートプロトコル（DDSなど）をROSミドルウェアと呼ばれる独自のレイヤーに分離することを前提としており、異なるプロトコルの実装に簡単に切り替えることができます。そのため、ROSコミュニティは長い議論の末、最近、2024年に予定されているZenohという軽量プロトコルに切り替えることを決定しました。このトピックについて詳しく知りたい場合は、2023年に検討されたすべてのDDSの代替案に関する情報が含まれている[ROS 2ミドルウェアの代替案レポート](https://discourse.ros.org/uploads/short-url/o9ihvSjCwB8LkzRklpKdeesRTDi.pdf)を参照することをお勧めします。

## myBuddyの冒険とRobonomics対応ドライバー

myBuddy 280はROS 2互換として販売されていましたが、ROS 2での完全な動作には不十分であることが判明しました（MoveIt2などのモーションプランニングソフトウェアなしでも）。まず、デフォルトで提供されているRaspberry Pi 4Bモデルを8 GBのRAMを搭載したより強力なものに交換する必要がありました。次に、メーカーから提供されたmyBuddy用のROS 2パッケージをテストした結果、問題が発生しました。通常オープンソースの世界では、何かが公開リポジトリに公開されているからといって、その機能が保証されるわけではありません。ロボットは現在サポートされていないROS 2 Galacticディストリビューションがプリインストールされており、2022年に期限切れとなりました（ちなみに、ディストリビューションのサポート期間については[こちら](https://docs.ros.org/en/rolling/Releases.html)で確認できます）。それでも、私たちは古いディストリビューションでロボットを実行しようと試み、すぐにいわゆるデッドロックに遭遇しました — つまり、起動したサブプログラム（または計算プロセス）がお互いの作業をブロックするような振る舞いです。調査の結果、これらのエラーはROS 2 HumbleのLTSディストリビューションで修正されていることがわかりました。

残念ながら、Elephant Roboticsの開発者は数年前にパッケージの更新を停止し、さらに、ロボットに必要なすべてのパッケージがROS 1からROS 2に移されていませんでした。そのため、私たちはこのタスクを自ら引き受けることにしました。ROS 2の低レベルAPIが利用できないため、私たちは自分たちのROS 2パッケージの[実装](https://github.com/Fingerling42/mybuddy280-ros2-robonomics)を開発することがより簡単だと考えました。ここでは、pymycobotというPythonモジュールを取り入れ、Robonomicsを介してmyBuddyの制御を追加することができました。

現在のカスタムドライバーは、両腕と手首の各関節の状態を取得し、それらに角度を送信することができます。また、Robonomicsデータログを使用してロボットの関節状態を公開し、ロボットのアドレスに起動関数を送信してリモート関節制御を行うことができます。試してみたい場合は、Raspberry Pi 4Bに新しいイメージとパッケージを再インストールしてROS 2のバージョンを更新すると、かなりの時間（約2〜4時間）がかかることに注意してください。

将来的には、ドライバーの機能を拡張し、キプロスの私たちの研究所内でRobonomicsを介してこのロボットをリモート制御できるようにする予定です。また、Robonomics ROS 2 Wrapperを公式のrosdistroパッケージリストに含め、ユーザーがROS 2プロジェクトを初期化する際に自動的にインストールできるようにしたいと考えています。

私たちの最新情報をお楽しみに！