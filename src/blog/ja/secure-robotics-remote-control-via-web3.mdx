---
title: "セキュアロボティクスリモートコントロール：Robonomicsソリューション"
date: 2024-04-19
published: true
locale: 'ja'
cover_image: /blog/images/secure-robotics-remote-control-via-web3/remote_control_cover.png
description: "自分のスマートデバイスをリモートで接続して操作することは、ユーザーの間で非常に人気のある機能です。しかし、このような些細なタスクでも、未経験のユーザーにとって多くの困難を引き起こします - NATの克服からセキュリティの問題まで。新しい記事では、これらの困難をRobonomicsの助けを借りてどのように克服できるかを示します。"
related: ['Robonomics Helps Enable Rust for ROS 2', 'Automation: Home meets Industrial']
abstract: "自分のスマートデバイスをリモートで接続して操作することは、ユーザーの間で非常に人気のある機能です。しかし、このような些細なタスクでも、未経験のユーザーにとって多くの困難を引き起こします - NATの克服からセキュリティの問題まで。新しい記事では、これらの困難をRobonomicsの助けを借りてどのように克服できるかを示します。"
tags: ['ROS 2', 'スマートホーム']
---

前の記事では、ロボット化されたスマートホームのインフラストラクチャで産業ソリューションの利点をどのように活用しているかについて話しました。ROS 2フレームワークとそのミドルウェアプロトコルが、自動デバイスの検出とそれらの間の密接な相互作用（リアルタイムでの相互作用も含む）をローカルネットワーク内で提供する方法を示しました。しかし、このアプローチは主に、いわゆる信頼されたゾーンに適しています - つまり、第三者が現れる可能性が低いコンピューターネットワークの部分です。この場合、実行されているすべてのプログラムを信頼し、プログラムがお互いにデータを交換する際に暗号化を使用する必要がないのと同様に、1つのコンピューター内で使用されていません。

しかし、ROS 2デバイスの動作を外部サービスと連携させる必要がある場合や、外部からそれらにリモートアクセスを提供する必要がある場合はどうでしょうか？そのような瞬間には、セキュリティの問題が発生します - ROS 2ノードの1つにアクセス権を取得した場合、外部サービス（および潜在的に悪意のある人物）は本質的に他のすべてのノードにアクセスできます - すべての内部DDSトラフィックを完全に盗聴し、利用可能なすべてのシステムサービスにアクセスできます。

セキュリティと速度/利便性の間の古典的なトレードオフは、主権を持つスマートホームシステムを安全な部分と安全でない部分に分割することで解決されます。

## ROS 2セキュリティ

ROS 2ノードのワークスペース内で特別なセキュリティ要件を持つゾーンを指定することは非常に非トリビアルなタスクです。標準のROS 2セキュリティパッケージ（[sros2](https://docs.ros.org/ja/rolling/Concepts/Intermediate/About-Security.html))は、[ros-core](https://ros.org/reps/rep-2001.html#id32)の一部であり、すべてのROS 2ディストリビューションが構築されているものであり、コア開発者によると、この問題を解決することを意図しています。これは、単一のローカルネットワーク内で比較的簡単な公開鍵基盤（PKI）を設定する機能を提供します。各ROS 2ノードに対して、他のノードのデータへのアクセスポリシーが設定され、さらにそのようなシナリオ用の標準ファイル - 暗号鍵と証明書が用意されています。プログラムの実行中、ノードはプロジェクトの起動段階で明示的に構成に書かれたアクセスが許可されたデータソースのみを「見る」ことができます。ただし、このアプローチには大きな欠点があります - システム内のすべてのトラフィックが暗号化されるため、DDSによって作成されたネットワーク負荷の下でパフォーマンスに影響を与える可能性があります。すべてのアクセスポリシーを書き出し、すべてのノードに対してキーを生成する必要があります。これは非常に設定と維持が難しいです。そして何よりも、ROS 2ミドルウェアの主な利点であるパフォーマンスを失ってしまいます。

## ブリッジ

別の解決策は、必要なデータを送信しながら他のすべてをプライベートに保つ、いわゆるゲートウェイを作成することです。通常、これはVPNまたはSSHトンネルを使用して実現されます。安全なデータ交換スペースに別のノードが作成され、外部接続用の公開アドレスを持っています。この場合、セキュリティ管理はこのノードのレベルでのみ行われます（基本的には外部世界への窓）、他のすべてに影響を与えることはありません。このアプローチは、プロジェクト[Husarnet](https://github.com/husarnet/husarnet)、[DDS Router](https://github.com/eProsima/DDS-Router)、および[Zenoh Bridge](https://github.com/eclipse-zenoh/zenoh-plugin-ros2dds)で使用されていますが、欠点もあります。このシナリオでは、厳密に相手先のIPアドレスやドメイン名にリンクされた安全な通信チャネルを確立する必要があります。これらは変更される可能性があり、ブロックされる可能性があり、攻撃の対象になる可能性があります。SSHが作成された当時、これは考慮されていませんでした。さらに、SSHは主にオペレーティングシステムのアクセス制御システムに依存しており、その固有の欠点を持っています。

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/remote_control_legacy_approach.png" alt="Classic Remote Control via public IP and SSH/VPN" />

*ユーザーが最近リモートでロボットに接続する方法は次のとおりです。ただし、この方法にはいくつかの欠点があります。一部の国でブロックされる可能性のある公開IPまたはDNS名が必要です。また、潜在的に安全でない場所（たとえば、~/.ssh）に追加の秘密鍵を保存する必要があります。*

主にシステム管理者やITスペシャリストによって使用されるSSHは、Bashコマンドラインの基本的な知識とオペレーティングシステムへの信頼が必要です。暗号化キーはファイルシステムまたはSSHエージェントに直接保存されるため、アクセスキーの管理は、一般ユーザーにとっては比較的複雑なタスクのままであり、データを保護する安全な方法として残ります。

## Web3ソリューション

上記の方法には欠点があることがわかりますので、Robonomicsが構築されているピアツーピアネットワーク技術を使用した問題の解決策を考えてみましょう。この場合、分散型のRobonomicsクラウドは、安全なルーティングテーブルと見なすことができ、その中の取引先のアドレスはノードの公開鍵です。DNSシステム（ドメイン名登録機関やサーバーを含む）やIPアドレスのブロックに依存しないように、ローカルのRobonomicsノードと取引先の公開鍵を知っている必要があります。Robonomicsが使用する[libP2P](https://libp2p.io/)ライブラリは、メッセージの配信に異なるトランスポートプロトコルを使用できます。

さらに、Web3技術の進化に伴い、プライベートキーを含む重要な情報を管理するための効率的な方法が登場しています。その1つがニーモニックフレーズまたはシードです。これは、分散型ネットワークでアカウントを作成するために使用される12または24の単語のセットです。この方法は便利で安全であり、初期化時に一度だけ外部媒体（たとえば、紙）に書かれたシードを使用してアカウントを回復するだけです。ニーモニックフレーズからマスターキーが作成され、さまざまなタスク用のキー階層を作成できます（**[階層的決定キー](https://docs.substrate.io/reference/command-line-tools/subkey/#hierarchical-deterministic-keys)**を参照）。これにより、キーの管理と紛失した場合の回復が簡素化されます。悪意のある者がニーモニックフレーズから作成されたキーの1つにアクセスしたとしても、他のキーに関する情報を取得することはできません。ソフト派生キー機能により、ルートアカウントの所有権を開示せずに確認できます。親公開鍵を使用して派生キーを生成できるため、ソフトキーは親を識別するために使用できます。キーを公開せずに子シードを生成します。

## Home Assistantでのリモートコントロール

接続プロセスを詳しく見てみましょう。分散型の[Robonomicsアプリケーション](https://robonomics.app/)（またはDApp）は直接ブラウザで動作し、追加のソフトウェアのインストールや大量のプログラムが存在する環境でキーをファイルシステムに保存する必要はありません。そのセキュリティが確実でないプログラムの環境でのキーの保存は不要です。アクセスキーの管理はPolkadot JS拡張機能を介して行われ、さらなる信頼性のために外部ハードウェアキーストレージ（例：[Polkadot Vault](https://wiki.polkadot.network/docs/polkadot-vault)）を使用することもできます。Robonomicsとのやり取りのための専用ソフトウェアに加えて、DAppにはHome Assistantへの接続を可能にする軽量なlibP2Pノードも含まれています。

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/robonomics_home_assistant_usecase.png" alt="Home Assistant Remote Control" />

Robonomics Webサービスのサブスクリプション所有者は、コントローラーとして知られるものを介してスマートホームインフラストラクチャへのアクセス権を管理します。このコントローラーは、デジタルツイン内のすべての機密情報を暗号化された形式で管理します。サブスクリプションに追加されたユーザーのみがこのデータを復号化できます。アクセスキーに加えて、デジタルツインにはDAppの構成と、いわゆるlibP2Pマルチアドレスも保存されており、DAppが安全な接続を行うために接続するためのものです。マルチアドレスは、libP2Pアプローチをユニークで柔軟なものにする革新の1つです。これは、ノード用のアドレスの特別な形式であり、特定のノードに連絡するための多くのIPアドレス、トランスポートおよびネットワーク識別子、プロトコル、ポートが存在することを意味します。サポートされているプロトコルの完全なリストは[仕様](https://github.com/multiformats/multiaddr/blob/master/protocols.csv)に示されています。

したがって、サブスクリプションに追加されたユーザーはRobonomicsデジタルツインからマルチアドレスを取り出し、自分だけが知っているPeer IDと安全な接続を確立します。成功です！

## ROS 2でのリモートコントロール

同様に、Robonomicsの既存の機能を使用してロボットとやり取りすることができます。Robossemblerチームは、Robonomics Grant Programの下で、[Robonomics Bridge](https://gitlab.com/robossembler/robonomics_bridge)として知られるProof of Conceptプロジェクトを開発しました。このブリッジは、あなたのROS 2ノードを、外部サービス、リモートワークステーション、または別のROS 2システムと接続します。

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/robonomics_ros2_usecase.png" alt="Robonomicsを使用したROS 2リモートコントロール" />

*家庭用ロボットのリモートコントロールの様子を示した図。このアプローチにはいくつかの重要な利点があります: パブリックIPは必要なく、ロボットへのアクセスはネットワークファイアウォール（NAT）を通じて可能であり、プライベート暗号鍵はディスクに保存されず、信頼性の高い保護がされています。*

ROS 2で使用されているプロトコルであるDDSは、ノード間の相互作用のためのパブリッシャー-サブスクライバーモデルと似ているため、libP2Pと自然に組み合わせることができます。 Robonomicsブリッジの助けを借りて、ROS 2ノードとそのインターフェース - トピック、サービス、メッセージタイプ（たとえば、eProsima Integration Serviceを使用する）は、外部からロボットとのやり取りが可能になるように宣言的に構成できます。これにより、リモートコンピュータに接続する際の追加のセキュリティレベルも提供されます。対向する相手のPeerIDを取得するメカニズムは、Home Assistantの場合と同じである可能性があります - Robonomicsノードからのデジタルツインリクエストを介して、ただし異なる点は、Home Assistantサーバーの代わりにROS 2ロボットがあり、libP2P-websocker-proxyの代わりにロボノミクスROS 2ラッパーがロボットに接続されていることです。

## 将来の潜在的な機会

しかしこれらは、分散型クラウド上のWeb3テクノロジーが提供できる可能性すべてではありません。上記で説明した例では、これらのテクノロジーがリモートコンピュータ間でメッセージデータストリームを比較的簡単に転送するために使用されています。

これは、Robonomicsネットワークスタックの基本輸送レベルと呼ぶことができ、より複雑な上位プロトコルの実装の基礎となります。 SSHの類似物から始まり、ユーザーがサイバー物理システムと対話的にやり取りすることを意味するもの、および多くのユーザーが自律ロボットインフラストラクチャとやり取りすることを意味するアプリケーションプロトコルまで、さまざまなプロトコルが含まれます。

たとえば、特定の製品の生産を開始する決定は、その製品の潜在的な消費者の組織内での投票にリンクされる可能性があり、経済的合理性を考慮します。現在、どの製品の生産を開始するかの決定は、将来的にその需要を満たす個々の企業の株式を取得できる投資メカニズムを通じて行われます。. もし消費者が新製品の開発や価格設定に積極的に参加できるようになれば、長期的には、生産が自動的に需要を満たすように再構築されるモードに切り替わることができます。これは消費者がネットワークに提供するデータに基づいて行われます。