---
title: 2024년 Polkadot Decoded에서 맥주 바 실험
date: 2024-07-19
published: true
locale: 'ko'
tags: ['이벤트', 'Polkadot', 'Web3']
cover_image: /blog/images/beer-bar-decoded2024/cover.png
description: '지난 주, Robonomics 팀이 브뤼셀에서 열린 Polkadot Decoded 행사를 방문했습니다. 그들은 ChaosDAO의 Free Beer Stand 주변 센서에서 다양한 측정치를 측정하는 실험을 진행했습니다. 팀은 참석한 사람 수와 그들이 바에 얼마나 관심이 있는지를 보고 싶어했습니다. 이 기사를 읽어 그들이 발견한 것을 알아보세요.'
---

지난 주, Robonomics 팀이 브뤼셀에서 열린 Polkadot Decoded 행사를 방문했습니다. 그들은 ChaosDAO의 [**Free Beer Stand**](https://polkadot.polkassembly.io/referenda/821) 주변 센서에서 다양한 측정치를 측정하는 실험을 진행했습니다. 팀은 참석한 사람 수와 그들이 바에 얼마나 관심이 있는지를 보고 싶어했습니다. 이 기사를 읽어 그들이 발견한 것을 알아보세요.

## 장비

실험을 위해 다음 센서들이 선택되었습니다:

- 온도 및 습도 센서
- 모션 센서
- 도어 센서
- 공기 질 센서
- 라즈베리 파이 4와 홈 어시스턴트 설치 및 Robonomics 통합을 사용하여 모든 데이터를 Web3 클라우드에 저장했습니다. 이 기사의 끝에서 이 데이터를 어떻게 얻을 수 있는지 설명이 나옵니다.

## 설치

바는 다음과 같았습니다:

<RbImage zoom src="/blog/images/beer-bar-decoded2024/bar.jpg" alt="맥주 바" /> 

맥주가 나눠졌던 주요 카운터. 카운터 뒤에는 수도꼭지와 음료수가 보관된 냉장고 2대가 있었습니다. 또한 오른쪽에는 작은 소파와 레이싱 게임이 장착된 PlayStation 1이 있었습니다.

<RbImage zoom src="/blog/images/beer-bar-decoded2024/play-zone.jpg" alt="플레이 존" /> 

도어 센서는 냉장고에 완벽하게 맞았습니다. 이를 통해 병을 꺼내기 위해 몇 번 열렸는지를 세어볼 수 있었습니다.

<RbImage zoom src="/blog/images/beer-bar-decoded2024/fridges.jpg" alt="냉장고" />

모션 센서는 TV에 다가갈 때만 작동하도록 PlayStation 영역에 설치되었습니다.게임패드를 가져오세요:

<RbImage zoom src="/blog/images/beer-bar-decoded2024/sofas.jpg" alt="PlayStation 존" />

또한 메인 바 카운터에 움직임 센서가 설치되어 있으며, 카운터에 직접 사람이 있을 때만 트리거되도록 방향이 조정되었습니다. 
이것은 왼쪽의 기둥에 볼 수 있습니다. 온도 및 습도 센서도 근처에 설치되었습니다:

<RbImage zoom src="/blog/images/beer-bar-decoded2024/column.jpg" alt="움직임 센서 설치" />

여러 개의 온도 센서가 바 카운터 안쪽과 인근의 커피스팟에 설치되었습니다.

맥주 미미-카운터도 설치되었는데, "맥주" 버튼이 눌렸을 때 5초 동안 녹색으로 밝아지거나 "누르지 마세요" 버튼이 눌렸을 때 빨간색으로 밝아집니다:

<RbImage zoom src="/blog/images/beer-bar-decoded2024/mem-beer.jpg" alt="mem-beer 카운터" />

## 얻은 데이터

**면책 조항: 이 섹션에서는 모든 데이터가 편리한 시각화를 위해 홈 어시스턴트 인터페이스에 표시됩니다.**
이 같은 데이터는 Robonomics 파라체인에서 얻을 수 있으며 비교할 수 있습니다. 지침은 나준에 제공될 예정입니다.

연구 기간: 연구 기간 동안 7월 11일 오후 16:00부터 7월 12일 오후 20:00까지의 시간을 취할 것이며, 이는 디코딩의 첫 날의 절반과 두 번째 날 전체에 해당합니다.

또한 바가 정오에 오픈되었음을 명확히해야 합니다. 이는 측정 가능한 간격을 제한합니다.

### 온도 및 습도

<RbImage zoom src="/blog/images/beer-bar-decoded2024/temperature.jpg" alt="온도 센서" />

첫째 날 (7월 11일) - 그래프에서 볼 수 있듯이 실내 온도는 25-27도로 편안하게 유지되었습니다.

<RbImage zoom src="/blog/images/beer-bar-decoded2024/temp11.png" alt="11일 온도" />

둘째 날 (7월 12일) - 온도가 약간 떨어졌지만 여전히 편안했습니다.

<RbImage zoom src="/blog/images/beer-bar-decoded2024/temp12.png" alt="12일 온도" />

온도 하락은 두 번째 날의 비와 관련이 있으며, 이는 습도 그래프에서 명확히 볼 수 있습니다. 습도가 10-15% 증가했습니다. 첫째 날:11.png" alt="습도 11일" />

둘째 날:

<RbImage zoom src="/blog/images/beer-bar-decoded2024/hum12.png" alt="습도 12일" />

### 동작 센서

<RbImage zoom src="/blog/images/beer-bar-decoded2024/motion-sesnors.jpg" alt="동작 센서" />

노란색은 바 근처에 누군가가 있었던 시간을 나타내고, 회색은 사람이 없었던 시간을 나타냅니다. 바의 동작 센서 - 첫째 날:

<RbImage zoom src="/blog/images/beer-bar-decoded2024/motionbar11.png" alt="바의 동작 센서 11일" />

둘째 날:

<RbImage zoom src="/blog/images/beer-bar-decoded2024/motionbar12.png" alt="바의 동작 센서 12일" />

그리고 플레이스테이션 지역 - 첫째 날:

<RbImage zoom src="/blog/images/beer-bar-decoded2024/motionplay11.png" alt="플레이 존의 동작 센서 11일" />

둘째 날:

<RbImage zoom src="/blog/images/beer-bar-decoded2024/motionplay12.png" alt="플레이 존의 동작 센서 12일" />

센서를 통해 거의 항상 바가 열려 있을 때 누군가가 계산대에 서 있었음을 알 수 있습니다.
또한 거의 절반의 시간 동안 누군가가 플레이스테이션에서 게임을 하고 있었습니다.

### 문 센서

<RbImage zoom src="/blog/images/beer-bar-decoded2024/door-sensors.jpg" alt="냉장고 문 센서" />

좋아요, 바 주변의 일반 지표를 살펴보았으니 이제 몇 가지 숫자를 얻어보겠습니다. 이를 위해 문 센서가 있습니다.
냉장고가 2대 있었습니다. 이 중 하나를 예로 들어 문이 열린 횟수를 어떻게 세는지 살펴봅시다.

<RbImage zoom src="/blog/images/beer-bar-decoded2024/door.png" alt="문 센서 예시" />

물론, 이 그래프에서 문이 열렸던 순간을 나타내는 노란색 줄의 수를 세어볼 수 있습니다.
하지만 이를 csv 파일로 내보내어 다음과 같이 얻을 수도 있습니다:

<RbImage zoom src="/blog/images/beer-bar-decoded2024/doorcsv.png" alt="문 csv 예시" />

여기서 각 행은 센서 상태 변경 시간을 보여줍니다. 따라서 단순히 행 수를 반으로 나누어서, 당신은냉장고 문을 열 때마다 숫자를 얻을 수 있습니다.
결과적으로 다음 표를 얻습니다:

|          | 냉장고 1 | 냉장고 2 |
| -------- |--------|---------|
| 첫째 날   | 76     | 78      |
| 둘째 날   | 111    | 87      |
| 합계      | 187    | 165     |

총 352번의 냉장고 문 개폐가 있었습니다. 이는 두 날 동안 가져간 맥주/물 병의 최소 개수라고 자신있게 말할 수 있습니다. 한 번의 문 개폐로 여러 병을 가져갈 수 있기 때문입니다.

### 맥주 미미-카운터

마지막으로, 맥주 미미-카운터입니다. 이는 둘째 날에만 설치되었습니다. "맥주"와 "누르지 말기"로 레이블된 버튼이 2개 있었습니다. 각 버튼이 몇 번 눌렸는지 확인해보겠습니다.

| 맥주       | 누르지 말기 |
|------------|--------------|
| 83         | 44           |

보시다시피, 사람들 중 약 2/3가 올바른 버튼을 선택했습니다.

## 데이터 확인

이제 블록체인에서 이 데이터를 가져오는 작업으로 넘어갑시다. 모든 데이터는 이 계정의 데이터 로그에 저장되어 있습니다 - "4EsopMUbxQH5NseBXiJcPkTy5ZRhs7XrjuMBqmoCzBqWQ9gB". [Subscan](https://robonomics.subscan.io/account/4EsopMUbxQH5NseBXiJcPkTy5ZRhs7XrjuMBqmoCzBqWQ9gB)에서 이를 열어봅시다.

모든 익스트린직을 볼 수 있습니다. 날짜별로 필터링해 보겠습니다. 약 140개의 익스트린직을 얻을 것입니다.

<RbImage zoom src="/blog/images/beer-bar-decoded2024/subscan.png" alt="subscan extrinsics" />

각각에는 텔레메트리가 포함된 IPFS CID가 있습니다. 임의의 익스트린직을 선택하고 그 안에서 데이터를 추출해 보겠습니다. 예를 들어, [이것](https://robonomics.subscan.io/extrinsic/0x4f1bd898b367f32414fd397094e132262fbeaa8b50e7288d9aed908a138382f7)입니다. 그 안에 있는 IPFS CID는 `QmZMkJo6StbfDVvGCqVnV3sZeG7R3cftt7WX`입니다.fdUVdpJ4c3`.

그런 다음이 스크립트를 사용하여 데이터를 해독하면됩니다. 필요한 것으로 줄 11의 IPFS CID를 바꿉니다:

```
import requests
from substrateinterface import Keypair, KeypairType
from robonomicsinterface import Account
import typing as tp
import json
import os

ADMIN_SEED="client teach develop blush just ginger depart sister orange rather measure park"
IPFS_HASH="QmZMkJo6StbfDVvGCqVnV3sZeG7R3cftt7WXfdUVdpJ4c3"

def decrypt_message(data: tp.Union[str, dict]) -> str:

    """암호화 된 데이터를 해독하는 메시지
    :param data: 암호화 된 데이터
    :param sender_address: 발신자 주소
    :param recipient_keypair: 수신자 계정 키페어

    :return: 해독 된 메시지
    """
    try:
        account = Account(ADMIN_SEED, crypto_type=KeypairType.ED25519)
        admin_keypair = account.keypair
        print(account.get_address())
        sender_public_key = admin_keypair.public_key
        if isinstance(data, str):
            data_json = json.loads(data)
        else:
            data
        if admin_keypair.ss58_address in data_json:
            decrypted_seed = _decrypt_message(
                data_json[admin_keypair.ss58_address],
                sender_public_key,
                admin_keypair,
            ).decode("utf-8")
            decrypted_acc = Account(decrypted_seed, crypto_type=KeypairType.ED25519)
            decrypted_data = _decrypt_message(data_json["data"], sender_public_key, decrypted_acc.keypair).decode(
                "utf-8"
            )
            return decrypted_data
        else:
            print(f"디바이스를 위한 해독 중 오류 발생: 계정이 디바이스에 없음")
    except Exception as e:
        print(e)

def _decrypt_message(encrypted_message: str, sender_public_key: bytes, admin_keypair) -> str:
    """수신자 개인 키 및 발신자 공개 키로 메시지를 해독합니다.
    :param encrypted_message: 해독 할 메시지
    :param sender_public_key: 발신자 공개 키

    :return: 해독 된 메시지
    """
    if encrypted_message[:2] == "0x":
        encrypted_message = encrypted_message[2:]
    bytes_encrypted```ko
 = bytes.fromhex(encrypted_message)
    return admin_keypair.decrypt_message(bytes_encrypted, sender_public_key)

def main():
    account = Account(ADMIN_SEED, crypto_type=KeypairType.ED25519)
    admin_keypair = account.keypair
    response = requests.get(f"<https://gateway.pinata.cloud/ipfs/{IPFS_HASH}>")
    print(response)
    with open("telemetry.txt", "w") as f:
        decrypted_content = decrypt_message(response.text)
        print(decrypted_content)
        f.write(decrypted_content)

if __name__ == "__main__":
    main()

```

결과적으로 "telemetry.txt" 파일이 생성됩니다. 내부에는 json이 포함되어 있습니다. 우리가 위에서 검토했던 모든 데이터가 포함될 것입니다. 이를 구문 분석해야 합니다.

## 결론

이러한 지표들 덕분에 ChaosDAO의 "무료 맥주" 아이디어가 성공적이었고, 사람들이 적극적으로 활용했음을 말할 수 있습니다. 맥주가 부족한 경우도 있었지만. 그리고 센서와 Robonomics 팀 덕분에 Kusama 네트워크에 저장된 데이터를 통해 이 이벤트의 양적 및 질적 지표를 확인할 수 있습니다.
