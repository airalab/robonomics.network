---
title: "Автоматизація: Поєднання домашнього та промислового"
date: 2024-03-24
published: true
locale: 'uk'
cover_image: /blog/images/automation-home-meets-industrial-mybuddy280/Cover.png
description: "ROS 2 - це фреймворк, який швидко набуває популярності для розробки робототехнічних додатків. Він включає накопичений досвід галузі та ділиться ним з глобальною спільнотою. Наша команда активно займається розробкою нових пакетів ROS 2 для роботів, які ми використовуємо, а також їх інтеграцією в децентралізовану мережу Robonomics."
related: ['Robonomics Helps Enable Rust for ROS 2']
abstract: "ROS 2 - це фреймворк, який швидко набуває популярності для розробки робототехнічних додатків. Він включає накопичений досвід галузі та ділиться ним з глобальною спільнотою. Наша команда активно займається розробкою нових пакетів ROS 2 для роботів, які ми використовуємо, а також їх інтеграцією в децентралізовану мережу Robonomics."
tags: ['ROS 2', 'Розумний дім']
---

Технології, розроблені в одній галузі, часто знаходять широке застосування в інших галузях, навіть якщо спочатку не були призначені для них. Так, Інтернет, спочатку розроблений для військового використання, розкрив свій повний потенціал у цивільній сфері, ставши неот'ємною частиною сучасного життя. Подібна тенденція може виникнути й у промисловості, де технології, розроблені для підприємницьких сценаріїв, також можуть приносити користь кінцевим користувачам.

Історично автоматизація дому та промислова робототехніка розвивалися окремо. У зв'язку з високою вартістю та питаннями безпеки промислові роботи переважно були обмежені великосерійним виробництвом. Програмне забезпечення для управління виробництвом було обмежене в межах власних систем виконання виробництва та систем комп'ютерно-підтриманого виробництва. Автоматизація дому в той же час зазвичай представляла собою систему досить простих пристроїв для взаємодії з гаджетами користувача, побутовою технікою, освітленням, опаленням, зв'язком. Акцент у зв'язку був зроблений на бездротовому зв'язку.

Проте ми спостерігаємо тенденції. З одного боку, бездротові протоколи зв'язку з сфери споживачів поступово адаптуються для промислових застосувань — наприклад, з'являються промислові версії Wi-Fi або Bluetooth. З іншого боку, маніпуляторні роботи стають більш доступними і починають розглядатися для використання поза межами промисловості. Навіть зараз ми можемо розмірковувати, як у майбутньому, наприклад, безпечні спільні роботи стануть неот'ємною частиною дому і зможуть зробити наше життя зручнішим, допомагаючи при готуванні та інших рутинних домашніх справах. Також, відкриті реалізації промислових протоколів зв'язку — таких як протокол проміжного програмного забезпечення DDS підзакріплення за фреймворком ROS 2 — стає спадщиною ентузіастів з усього світу.

ROS 1 був розроблений для управління одиночним роботом і не відповідав вимогам виробничих підприємств: робота в реальному часі, стійкість до відмов при нестабільних умовах зв'язку, взаємодія з великою кількістю пристроїв. Так почалася розробка ROS 2, який спочатку був спрямований саме на потреби промисловості і зараз стає основним у робототехніці. У середині 2023 року відбулося важливе подія — через 5 років після появи ROS 2 Dashing у 2019 році, кількість пакетів ROS 2, які використовують інженери, за даними [metrics.ros.org](https://metrics.ros.org/packages_rosdistro.html), перевищила кількість пакетів ROS 1, і зараз близько 70% програмних пакетів, завантажених з офіційних репозиторіїв, призначені для ROS 2.

## Переваги ROS 2 для сценаріїв автоматизації вдома

Команда Robonomics перебуває на передовій цього процесу і активно підтримує спільноту ROS 2. З нашою підтримкою розробляються зв'язки ROS 2 для Rust (див. їх [у нашому блозі](https://robonomics.network/blog/ros-2-rust-report-2022/)), а також [обгортка ROS 2](https://github.com/Fingerling42/robonomics-ros2) для використання основних функцій децентралізованого хмарного сервісу Robonomics. Ми також регулярно тестуємо пристрої, які підтримують ROS 2, щоб специфічно перевірити наше програмне забезпечення на них. Одним з таких роботів є недавно придбаний нами myBuddy 280 — недорогий дворукий маніпулятор для навчання та досліджень від [Elephant Robotics](https://www.elephantrobotics.com/en/). Робот може піднімати приблизно до 250 грамів і коштує близько 1700 доларів, що робить його відносно доступним для початківців.

<RbImage zoom src="/blog/images/automation-home-meets-industrial-mybuddy280/pic_1_myBuddy_280.png" alt="дворукий робот-маніпулятор myBuddy 280" />

На прикладі цього робота дуже чітко видно переваги ROS 2, які дозволяють потенційне використання цього фреймворку в сценаріях автоматизації вдома. Зокрема, завдяки протоколу проміжного програмного забезпечення DDS, можна використовувати myBuddy разом з відносно потужним настільним ПК та додати повноцінного робота до типової структури розумного будинку. Якщо робот і комп'ютер пов'язані черезу тому же локальній мережі та використовують той самий [DOMAIN_ID](https://docs.ros.org/en/rolling/Concepts/Intermediate/About-Domain-ID.html), вони можуть спілкуватися без будь-якої додаткової конфігурації. Основне програмне забезпечення, таке як драйвер та пакети опису апаратного забезпечення, працюють на Raspberry Pi робота. Решта необхідного програмного забезпечення, таке як "розумні" планувальники руху, наприклад MoveIt, симулятори, такі як Gazebo, інструменти моніторингу та візуалізації, такі як RViz, вузол Robonomics, машинне навчання, пакетна обробка журналів, вузол передачі даних IPFS та інші завдання, які вимагають значної обчислювальної потужності, можуть бути запущені на цій потужній машині.

Ця організація дозволяє оптимально розподіляти обчислювальні ресурси, в сутності створюючи архітектуру, схожу на мікросервіси. Завдяки платформі ROS 2 та базовому протоколу проміжного програмного забезпечення DDS ця гнучкість можлива, дозволяючи кожному пристрою виконувати завдання, які найкраще підходять його можливостям. Завдяки автоматичним механізмам виявлення пристроїв, вбудованим у DDS, теми та сервіси ROS 2 будуть знаходити один одного без будь-яких додаткових налаштувань.

<RbImage zoom src="/blog/images/automation-home-meets-industrial-mybuddy280/pic_2_ros2_dds_smart_home.png" alt="Розумний будинок з ROS 2 та DDS" />

Також слід зауважити, що архітектура ROS 2 передбачає розділення транспортного протоколу (наприклад, DDS) на окремий шар, який називається ROS Middleware, що полегшує перехід від однієї реалізації протоколу до іншої. Таким чином, після довгих обговорень спільнота ROS нещодавно вирішила перейти на більш легкий протокол під назвою Zenoh, запланований на 2024 рік. Для більш детального вивчення цієї теми ми рекомендуємо звернутися до [звіту про альтернативи проміжного програмного забезпечення ROS 2](https://discourse.ros.org/uploads/short-url/o9ihvSjCwB8LkzRklpKdeesRTDi.pdf), який містить інформацію про всі альтернативи DDS, розглянуті у 2023 році.

## Пригоди мого друга та сумісний з Robonomics драйвер

Незважаючи на те, що myBuddy 280 просувається як сумісний з ROS 2, виявилося, що він недостатній для повноцінної роботи в ROS 2 (навіть без програмного забезпечення для планування руху, такого як MoveIt2). Спочатку нам довелося замінити поставлений за замовчуванням модель Raspberry Pi 4B на потужніший з 8 ГБ оперативної пам'яті, щоб задовольнити наші потреби. По-друге, після тестування пакету ROS 2 для myBuddy від виробника ми стикалися з проблемами. Як це зазвичайУ світі відкритого програмного забезпечення те, що щось опубліковано в публічному репозиторії, не гарантує його функціональності. Робот був попередньо встановлений з нині непідтримуваною дистрибуцією ROS 2 Galactic, яка закінчилася у 2022 році (до речі, ви можете прочитати про періоди підтримки дистрибуцій [тут](https://docs.ros.org/en/rolling/Releases.html)). Незважаючи на все, ми спробували запустити робота на застарілій дистрибуції і швидко стикалися з так званими "мертвими замками" - такою поведінкою, коли запущені підпрограми (або обчислювальні процеси) блокують роботу один одного. Після деяких досліджень ми виявили, що ці помилки були виправлені в LTS-дистрибуції ROS 2 Humble.

На жаль, розробники Elephant Robotics припинили оновлення пакунків кілька років тому, і, що ще важливіше, не всі необхідні пакунки для робота були перенесені з ROS 1 в ROS 2. Тому ми вирішили взяти цю задачу на себе. У зв'язку з недоступністю API низького рівня для ROS 2, ми виявили, що легше розробляти нашу власну [реалізацію](https://github.com/Fingerling42/mybuddy280-ros2-robonomics) пакунка ROS 2, де ми могли додати управління myBuddy через Robonomics. Для цього ми взяли модуль Python [pymycobot](https://pypi.org/project/pymycobot/) та реалізували власний драйвер ROS 2.

Поточний користувацький драйвер може отримувати стани кожного з'єднання для обох рук і зап'ястя, а також відправляти кути до них, публікувати стани з'єднань робота за допомогою Robonomics datalog та віддалено керувати з'єднанням, відправляючи функцію запуску на адресу робота. Якщо ви хочете спробувати це, будь ласка, зверніть увагу, що оновлення версії ROS 2 шляхом перевстановлення нового зображення з пакунками на Raspberry Pi 4B може зайняти значну кількість часу (приблизно 2-4 години).

У майбутньому ми плануємо розширити функції драйвера та забезпечити віддалене керування цим роботом через Robonomics у нашій лабораторії на Кіпрі. Ми також хочемо включити обгортку Robonomics ROS 2 в офіційний список пакунків rosdistro, щоб користувачі могли встановити її автоматично при ініціалізації проекту ROS 2.

Слідкуйте за нашими оновленнями!