---
title: Δοκιμή του Neon EVM με Έξυπνα Συμβόλαια Robonomics
date: 2022-10-03
published: true
locale: 'el'
tags: ['Robonomics στο Ethereum', 'Συνεργασίες', 'Έξυπνα Συμβόλαια', 'Neon']
cover_image: /blog/images/testing-neon-with-robonomics/blog_cover_neon_multi-agent.jpg
description: "Ο σκοπός αυτών των δοκιμών ήταν να επιβεβαιωθεί η έτοιμοτητα της πλατφόρμας Neon να μεταβεί στο στάδιο παραγωγής χρησιμοποιώντας έξυπνα συμβόλαια Robonomics, τα οποία επιτρέπουν σε κυβερνο-φυσικά συστήματα (ρομπότ) να πραγματοποιούν τεχνικο-οικονομικές συναλλαγές."
abstract: ""
---

## Πολύ Σύντομα

Ο σκοπός αυτών των δοκιμών ήταν να επιβεβαιωθεί η έτοιμοτητα της [Neon](https://neon-labs.org/) πλατφόρμας να μεταβεί στο στάδιο παραγωγής χρησιμοποιώντας έξυπνα συμβόλαια Robonomics, τα οποία επιτρέπουν σε κυβερνο-φυσικά συστήματα (ρομπότ) να πραγματοποιούν τεχνικο-οικονομικές συναλλαγές.

Στο δίκτυο Robonomics, δημιουργείται αλληλεπίδραση μεταξύ δύο μερών: Ο Promisee - αυτός που παραγγέλνει την υπηρεσία, στέλνει μια περιγραφή της τεχνικής εργασίας και μεταφέρει κεφάλαια για την εκτέλεσή της. Ο Promisor - αυτός που παρέχει την υπηρεσία. Δοκιμάστηκε ένα τυπικό σενάριο, όπου συνάφθηκε ένα συμβόλαιο ευθύνης μεταξύ ενός Promisee και ενός Promisor - ακολούθησε η επικύρωση της παραγόμενης εργασίας από ένα τρίτο μέρος, καθώς και η πληρωμή προμήθειας στον κόμβο που συνόδευε το συμβόλαιο μεταξύ των μερών.

Για αυτό το παράδειγμα, χρησιμοποιήθηκε μια προσομοίωση ενός ρομποτικού βραχίονα, ο οποίος ζητήθηκε να εκτελέσει μια ακολουθία ενεργειών. Οι δοκιμές ήταν επιτυχείς.

## Εύρος και Στόχοι των Δοκιμών

Οι μηχανικοί των [Πολυ-Παραγόντων Συστημάτων](https://multi-agent.io/) εργάζονται με το [Δίκτυο Robonomics](https://robonomics.network/) εδώ και αρκετά χρόνια. Η πρώτη υλοποίηση του Δικτύου Robonomics δημιουργήθηκε για το δίκτυο Ethereum. Πρόκειται για ένα σύνολο έξυπνων συμβολαίων για την επικοινωνία μηχανή-προς-μηχανή.

Το κέντρο του Δικτύου Robonomics είναι το [Συμβόλαιο Ευθύνης](https://github.com/airalab/robonomics_contracts/blob/master/contracts/robonomics/Liability.sol), ένα έξυπνο συμβόλαιο που αναπαράγει την τυπική σχέση μεταξύ του πελάτη μιας υπηρεσίας (Promisee) και του παρόχου της υπηρεσίας (Promisor), και περιλαμβάνει τις τεχνικές και οικονομικές παραμέτρους της συναλλαγής μεταξύ τους. Τα μέρη μπορούν να είναι είτε ένα αυτόνομο πράκτορα και ένα άτομο (αλληλεπίδραση ανθρώπου-μηχανής), είτε αποκλειστικά δύο αυτόνομοι πράκτορες (αλληλεπίδραση μηχανής-μηχανής). Ο Promisee και ο Promisor μεταδίδουν μηνύματα με τις παραμέτρους τηςΗ τεχνικο-οικονομική τους συναλλαγή, και στη συνέχεια η ολοκλήρωση της συναλλαγής παρέχεται από έναν ειδικό κόμβο - τον Πάροχο - ο οποίος αναζητά ταιριάσματα αυτών των παραμέτρων. Οι Πάροχοι ελέγχονται από το [Lighthouse](https://github.com/airalab/robonomics_contracts/blob/master/contracts/robonomics/Lighthouse.sol), το οποίο είναι ένα ειδικό έξυπνο συμβόλαιο που εκτελεί μια συναλλαγή όταν ο πάροχος καθιερώνει ένα αγοράσιμο ταίριασμα μεταξύ των μερών.

Υπάρχουν τρεις σενάριο στα οποία μπορεί να πραγματοποιηθεί η εκπλήρωση μιας υποχρέωσης:

1. Απλή υπόσχεση (χωρίς επαλήθευση του τελικού αποτελέσματος και χωρίς πληρωμή προμηθευτών στον Πάροχο)
2. Υποχρέωση με πληρωμή προμηθευτών στον Πάροχο
3. Υπόσχεση με πληρωμή στον Πάροχο και επαλήθευση των αποτελεσμάτων με τη βοήθεια τρίτου μέρους - παρατηρητικού δικτύου.

Ο σκοπός αυτού του τεστ είναι να δοκιμάσει το πιο πολύπλοκο, τρίτο σενάριο Robonomics στην πλατφόρμα Neon EVM.

## Περιγραφή Σεναρίων Δοκιμής

Καθώς αναπτύσσουμε τις βιομηχανικές ζώνες και την υποδομή των σύγχρονων πόλεων, είναι πολύ πιθανή η εμφάνιση πλήρως αυτοματοποιημένων επιχειρήσεων και υπηρεσιών που ελέγχονται από κυβερνο-φυσικά συστήματα (CPS) και που παρέχουν τις υπηρεσίες τους ως αυτόνομοι παράγοντες. Σε σχέση με αυτό, μπορούμε επίσης να αναμένουμε τη δημιουργία δικτύων αυτόνομων CPS με σκοπό την αύξηση της ταχύτητας και της ποιότητας της επικοινωνίας στη διαδικασία παραγωγής και παροχής υπηρεσιών.

Προκειμένου να εκμεταλλευτούμε πλήρως τις δυνατότητες των έξυπνων συμβολαίων, επιλέχθηκε ένα σενάριο αλληλεπίδρασης μεταξύ δύο αυτόνομων οικονομικών παραγόντων. Ας εξετάσουμε τον κύκλο ζωής της υποχρέωσης στο δίκτυο Robonomics:

![Κύκλος Ζωής Υποχρέωσης](/blog/images/testing-neon-with-robonomics/step-by-step-3.jpg)

Η παραπάνω εικόνα δείχνει ότι ο πάροχος του δικτύου Robonomics καλεί το συμβόλαιο Lighthouse, το οποίο από τη σειρά καλεί το [εργοστάσιο συμβολαίων](https://github.com/airalab/robonomics_contracts/blob/master/contracts/robonomics/Factory.sol) για να δημιουργήσει το συμβόλαιο Υποχρέωσης. Το συμβόλαιο Υποχρέωσης περιέχει δεδομένα σχετικά με τη συναλλαγή, όπως οι όροι αναφοράς, η πληρωμή για την υπηρεσία, η διεύθυνση του επικυρωτή και η προθεσμία.

Για περισσότερες πληροφορίες σχετικά με τις πιθανές περιπτώσεις χρήσης του Robonomics, ελέγξτε τη σελίδα [R&D](https://wiki.robonomics.network/docs/en/r-and-d-based-on-robonomics-network/#launching-a-drone-under-the-control-of-a-decentralized-computer) του Robonomics!

Για να αντιγράψουμε ολόκληρη τη υποδομή του Robonomics στο δίκτυο Neon, θα υλοποιήσουμε ένα σενάριο εκκίνησης ρομπότ μέσω ενός συμβολαίου Υποχρέωσηςπαρόμοιο με αυτό το [παράδειγμα](https://wiki.robonomics.network/docs/el/kuka/). Εάν το σενάριο μπορεί να επαναληφθεί, τότε όλες οι λειτουργίες θα λειτουργήσουν.

## Παραδοτέα

Ο πηγαίος κώδικας για τα συμβόλαια Robonomics είναι διαθέσιμος [εδώ](https://github.com/airalab/robonomics_contracts).
Τα συμβόλαια χρησιμοποιούν πολλά χαρακτηριστικά του Ethereum VM τα οποία περιλαμβάνουν:

- ERC20 [XRT](https://github.com/airalab/robonomics_contracts/blob/master/contracts/robonomics/XRT.sol) Token
- [Factory](https://github.com/airalab/robonomics_contracts/blob/master/contracts/robonomics/Factory.sol)
- Δικό του συμβόλαιο για το [ENS](https://github.com/airalab/robonomics_contracts/blob/master/contracts/ens/ENS.sol)
- [Προξενιό](https://github.com/airalab/robonomics_contracts/blob/master/contracts/misc/SharedCode.sol) για συμβόλαια
- Διάφοροι τροποποιητές και ρόλοι σε συμβόλαια

Διευθύνσεις συμβολαίων στο δίκτυο Neon devnet https://devnet.neonevm.org

| Όνομα Συμβολαίου  | Διεύθυνση                                    |
|----------------|--------------------------------------------|
| Migrations     | 0x1DC538bE2C8572509a571B150f11aB55E52EF12E |
| ENS            | 0xa7AEa12F60D0278F01e14DBC7cc459d04d051406 |
| DutchAuction   | 0xF44F8803548D72Dbc3E28340EFD7b5328aa4F058 |
| Liability      | 0xA694196351dc1488e3884eCc6b650F0d8D55346a |
| Lighthouse     | 0x80FB5CC4c396E272b56700E6ffF5DBf4661013A8 |
| XRT            | 0x3322d7D99cF65Cab5A92073c928b5E9674af3c29 |
| PublicAmbix    | 0x85c03bE5ccFf11E79a0A776D183eF067590549d1 |
| Factory        | 0xCFa833bF0D46369D9024f95c9C8dFa1E4a07806C |
| PublicResolver | 0xAC9E9AA8A4cB524FE87f2b14489F1D6bE68dc46e |

[Κώδικας πηγής](https://github.com/Multi-Agent-io/neon-kuka-demo) για το σενάριο

## Αλλαγές που Έγιναν στα Αρχικά Συμβόλαια

Τα συμβόλαια είναι γραμμένα για το Solidity 0.5.0. Ως τέτοιο, δεν απαιτήθηκαν αλλαγές κατά την ανάπτυξη και χρήση των συμβολαίων.

## Ροή Δοκιμής

Γενικά, η δοκιμή αποτελείται από την αποστολή αντίστοιχων μηνυμάτων από έναν πράκτορα σε έναν άλλο.

Στη συνέχεια, ο Promisor βρίσκει ένα νέο συμβόλαιο υποχρέωσης στο δίκτυο και αρχίζει να το εκτελεί. Μετά την ολοκλήρωση της εργασίας, στέλνεται ένα μήνυμα με το αποτέλεσμα, το οποίο καταγράφεται στο συμβόλαιο.

Οδηγίες βήμα προς βήμα για την εκκίνηση βρίσκονται στο [README.md](https://github.com/Multi-Agent-io/neon-kuka-demo/blob/main/README.md)

## Αναλυτικά Αποτελέσματα Δοκιμής

Βίντεο της διαδικασίας

<YouTube id="https://youtu.be/fYJVF7KrNnI" posterQuality="max" />

![Υποχρέωση](/blog/images/testing-neon-with-robonomics/liability.jpg)

Κατά την έναρξη της προσομοίωσης, δημιουργείται ένα μήνυμα προσφοράς, και ένα μήνυμα ζήτησης έρχεται από τον Promisee, μετά από το οποίο δημιουργείται ένα συμβόλαιο υποχρέωσης χρησιμοποιώντας τη λειτουργία createLiability του συμβολαίου Lighthouse. Με τη βοήθεια του συμβολαίου XRT, τα τοκεν μεταφέρονται από τη διεύθυνση του Promisee στη διεύθυνση του συμβολαίου υποχρέωσης.

Αφού έχει ανακαλυφθεί ένα νέο συμβόλαιο υποχρέωσης στο Neon devnet, ο πράκτορας αρχίζει να εργάζεται. Το αποτέλεσμα της εργασίας (τηλεμετρία) γράφεται σε ένα αρχείο και στέλνεται στο IPFS, η κατακερματισμένη τιμή από το αρχείο αποθηκεύεται ως αποτέλεσμα.

Μετά την ολοκλήρωση της εργασίας, το συμβόλαιο υποχρέωσης ολοκληρώνεται χρησιμοποιώντας τη λειτουργία finalizeLiability() του συμβολαίου Lighthouse και τα τοκεν μεταφέρονται από τη διεύθυνση της υποχρέωσης στις διευθύνσεις του Promisor και του Validator.

Η επιτυχής εκτέλεση της προσομοίωσης έδειξε ότι όλα τα συμβόλαια λειτούργησαν σωστά και η πλατφόρμα Neon λειτουργεί.

## Μειονεκτήματα της Πλατφόρμας Neon

### Το Truffle αποτυγχάνει αν δεν λάβει απάντηση από το δίκτυο

Κατά τη διαδικασία ανάπτυξης συμβολαίων, διαπιστώθηκε ότι το πλήρεξ δεν επιστρέφει πάντα έγκαιρα απάντηση, για αυτό το λόγο το Truffle τερματίζει με σφάλμα:

<RbCode>

```sh
TypeError: Cannot read properties of null (reading 'from')                                    
    at Web3InterfaceAdapter.(<ανώνυμο>) (/usr/lib/node_modules/truffle/build/webpack:/packages/interface-adapter/dist/adapter/web3/index.js:71:1)                                           
    στον Generator.next (<ανώνυμο>)                                                          
    σε πλήρη εκπλήρωση (/usr/lib/node_modules/truffle/build/webpack:/packages/interface-adapter/dist
/adapter/web3/index.js:5:43)                                                                  
    στην εκτέλεση μικρών εργασιών (<ανώνυμο>)
    στην επεξεργασία των ticks και των απορρίψεων (node:internal/process/task_queues:96:5)
Truffle v5.5.23 (πυρήνας: 5.5.23)
Node v16.14.0

Δεν ήταν δυνατό να βρεθεί μια σχέση μεταξύ των συνθηκών δοκιμής και της εμφάνισης ενός σφάλματος, αλλά πιθανότατα το Neon EVM δεν μπορεί να στείλει μια απόδειξη συναλλαγής και το Truffle δεν μπορεί να επεξεργαστεί μια μηδενική απάντηση.

Εάν προσθέσουμε χρονικό όριο και επανάληψη εδώ [index.ts#L75](https://github.com/trufflesuite/truffle/blob/develop/packages/interface-adapter/lib/adapter/web3/index.ts#L75), τότε η αναπτυξιακή διαδικασία θα πρέπει να συνεχιστεί χωρίς σφάλματα.

### Χωρίς Σημείο Πρόσβασης WS/WSS

Το Neon EVM δεν έχει ένα σημείο πρόσβασης WS/WSS αντίθετα με το Ethereum, που καθιστά αδύνατη την εγγραφή σε συμβάντα από το δίκτυο. Επομένως, κατά τη διάρκεια των δοκιμών, παρακολουθήσαμε τα συμβάντα χειροκίνητα.

### Χωρίς Ονόματα Συμβάντων

Το Neon EVM επιστρέφει αρκετά φτωχές περιγραφές συμβάντων μετά από μια συναλλαγή, για παράδειγμα:

<RbCode> [Αντικείμενο]
    },
...
```
</RbCode>

Αντί για 0, 1, κ.λπ. περιμέναμε να δούμε ονομασμένα γεγονότα.

## Συμπέρασμα

Χρησιμοποιώντας την πλατφόρμα Neon EVM, δοκιμάστηκε με επιτυχία ένα σενάριο όπου ένα συμβόλαιο ευθύνης μεταξύ ενός Υπόσχομενου και ενός Υπόσχοντος ολοκληρώθηκε με την επόμενη επικύρωση του αποτελέσματος της εργασίας που εκτελέστηκε από τρίτο μέρος. Επιπλέον, συμμετείχε ένας Πάροχος, ο οποίος ελέγχθηκε την συμπτωματικότητα της προσφοράς και της ζήτησης μεταξύ των μερών και έλαβε προμήθεια για αυτήν την εργασία.

Η παρουσίαση χρησιμοποίησε μια προσομοίωση ενός ρομποτικού βραχίονα που επρόκειτο να εκτελέσει μια ακολουθία ενεργειών. Ως αποτέλεσμα της εργασίας, το ρομπότ έστειλε ένα αρχείο με τηλεμετρία που λήφθηκε κατά τη διάρκεια της εργασίας.

Παρά τις κάποιες ιδιαιτερότητες στη λειτουργία του δικτύου, τελικά, όλα τα συμμετέχοντα συμβόλαια έδειξαν τη λειτουργικότητά τους στο περιβάλλον του Neon.