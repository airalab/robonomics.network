import{r as l,d as x,w as P,e as T,f as V}from"./runtime-core.esm-bundler.Ck1WV_rV.js";function A(i,L={}){const c=l(0),r=L.colors||["blue","yellow","pink"],t=l(0),a=l(0),u=5,m=500,d=l(0),f=l(!1),v=l(!1),n=l(null),y=x(()=>r[t.value]),M=x(()=>({model:!0,"model-noanimation":i.noanimation})),g=()=>{i.noanimation&&!f.value&&n.value.classList.contains("in-viewport")&&(f.value=!0,w())},w=()=>{a.value<u&&(t.value=(t.value+1)%r.length,t.value===0&&a.value++,setTimeout(w,m))},h=()=>{const e=n.value.getBoundingClientRect(),o=window.innerHeight,s=o*.75,C=o+e.height;if(e.top>s)c.value=0;else{const p=Math.min(Math.max(o-e.top,0),C);c.value=Math.max(0,Math.min(1,(p-s)/(C-s)))}const S=e.top<o&&e.bottom>0,E=Date.now();S&&a.value<u&&E-d.value>m&&(t.value=(t.value+1)%r.length,t.value===0&&a.value++,d.value=E),a.value>=u&&(t.value=0),i.noanimation||n.value.querySelectorAll(".model:not(.model-noanimation) .img").forEach(k=>{k.style.setProperty("--koef",c.value)})},b=()=>{const e=n.value.querySelectorAll("img");let o=0;e.forEach(s=>{s.complete?o++:s.onload=()=>{o++,o===e.length&&(v.value=!0)}}),o===e.length&&(v.value=!0)},I=e=>{e.forEach(o=>{o.target&&o.target.classList.toggle("in-viewport",o.isIntersecting)})};return P(v,e=>{e&&(i.noanimation?setTimeout(()=>{g(),window.addEventListener("scroll",g)},1e3):window.addEventListener("scroll",h))}),T(()=>{b();const e=new IntersectionObserver(I,{rootMargin:"-300px 0px"});n.value&&e.observe(n.value)}),V(()=>{i.noanimation?window.removeEventListener("scroll",g):window.removeEventListener("scroll",h)}),{scrollProgress:c,colors:r,colorIndex:t,cycleCount:a,maxCycles:u,colorChangeDelay:m,lastColorChangeTime:d,hasEnteredViewport:f,imagesLoaded:v,showColor:y,classes:M,modelContainer:n}}export{A as u};
